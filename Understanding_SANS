https://www.sans.org/event/october-singapore-2019

# FOR508: Advanced Incident Response, Threat Hunting, and Digital Forensics	GCFA	Joshua Lemon #
Detect how and when a breach occurred
Identify compromised and affected systems
Perform damage assessments and determine what was stolen or changed
Contain and remediate incidents
Develop key sources of threat intelligence
Hunt down additional breaches using knowledge of the adversary
DAY 0: A 3-letter government agency contacts you to say an advanced threat group is targeting organizations like yours, and that your organization is likely a target. They won't tell how they know, but they suspect that there are already several breached systems within your enterprise. An advanced persistent threat, aka an APT, is likely involved. This is the most sophisticated threat that you are likely to face in your efforts to defend your systems and data, and these adversaries may have been actively rummaging through your network undetected for months or even years.

This is a hypothetical situation, but the chances are very high that hidden threats already exist inside your organization's networks. Organizations can't afford to believe that their security measures are perfect and impenetrable, no matter how thorough their security precautions might be. Prevention systems alone are insufficient to counter focused human adversaries who know how to get around most security and monitoring tools.

The key is to constantly look for attacks that get past security systems, and to catch intrusions in progress, rather than after attackers have completed their objectives and done significant damage to the organization. For the incident responder, this process is known as "threat hunting". Threat hunting uses known adversary behaviors to proactively examine the network and endpoints in order to identify new data breaches.

Threat hunting and Incident response tactics and procedures have evolved rapidly over the past several years. Your team can no longer afford to use antiquated incident response and threat hunting techniques that fail to properly identify compromised systems, provide ineffective containment of the breach, and ultimately fail to rapidly remediate the incident. Incident response and threat hunting teams are the keys to identifying and observing malware indicators and patterns of activity in order to generate accurate threat intelligence that can be used to detect current and future intrusions.

This in-depth incident response and threat hunting course provides responders and threat hunting teams with advanced skills to hunt down, identify, counter, and recover from a wide range of threats within enterprise networks, including APT nation-state adversaries, organized crime syndicates, and hacktivists. Constantly updated, FOR508: Advanced Incident Response and Threat Hunting addresses today's incidents by providing hands-on incident response and threat hunting tactics and techniques that elite responders and hunters are successfully using to detect, counter, and respond to real-world breach cases.


The course uses a hands-on enterprise intrusion lab -- modeled after a real-world targeted APT attack on an enterprise network and based on APT group tactics to target a network -- to lead you to challenges and solutions via extensive use of the SIFT Workstation and best-of-breed investigative tools.

During the intrusion and threat hunting lab exercises, you will identify where the initial targeted attack occurred and how the adversary is moving laterally through multiple compromised systems. You will also extract and create crucial cyber threat intelligence that can help you properly scope the compromise and detect future breaches.

During a targeted attack, an organization needs the best incident response team in the field. FOR508: Advanced Incident Response and Threat Hunting will train you and your team to respond, detect, scope, and stop intrusions and data breaches.

GATHER YOUR INCIDENT RESPONSE TEAM - IT'S TIME TO GO HUNTING



FOR508 Course Topics

Advanced use of a wide range of best-of-breed open-source tools and the SIFT Workstation to perform incident response and digital forensics.
Hunting and responding to advanced adversaries such as nation-state actors, organized crime, and hacktivists.
Threat hunting techniques that will aid in quicker identification of breaches.
Rapid incident response analysis and breach assessment.
Incident response and intrusion forensics methodology.
Remote and enterprise incident response system analysis.
Windows live incident response and scaling collection of triage data.
Investigating and countering living of the land attacks, including PowerShell and WMI.
Memory analysis during incident response and threat hunting.
Transitioning memory analysis skills to enterprise detection and response (EDR) platforms
Detailed instruction on compromise and protection of Windows enterprise credentials.
Internal lateral movement analysis and detection.
Rapid and deep-dive timeline creation and analysis.
Volume shadow copy exploitation for hunting threats and incident response.
Detection of anti-forensics and adversary hiding techniques.
Discovery of unknown malware on a system.
Adversary threat intelligence development, indicators of compromise, and usage.
Cyber-kill chain strategies.
Step-by-step tactics and procedures to respond to and investigate intrusion cases


There are ways to gain an advantage against the adversaries targeting you -- it starts with the right mindset and knowing what works.

Incident responders and threat hunters should be armed with the latest tools, memory analysis techniques, and enterprise methodologies to identify, track, and contain advanced adversaries and to remediate incidents. Incident response and threat hunting analysts must be able to scale their analysis across thousands of systems in their enterprise. This section examines the six-step incident response methodology as it applies to incident response for advanced threat groups. We will show the importance of developing cyber threat intelligence to impact the adversaries' "kill chain". We will also demonstrate live response techniques and tactics that can be applied to a single system and across the entire enterprise.

Endpoint detection and response (EDR) capabilities are increasingly a requirement to track targeted attacks by an APT group or organized crime syndicates that can rapidly propagate through hundreds of systems. Rapid response to multiple distributed systems cannot be accomplished using the standard "pull the hard drive" forensic examination methodology. Such an approach will alert the adversaries that you are aware of them and may allow them to adapt quickly and exfiltrate sensitive information in response.

Students will receive a full six-month license of F-Response Enterprise Edition, enabling them to use their workstation or the SIFT workstation to connect and script actions on hundreds or thousands of systems in the enterprise. This capability is used to benchmark, facilitate, and demonstrate new incident response and threat hunting technologies that enable a responder to look for indicators of compromise across the entire enterprise network.



Exercises
SIFT Workstation orientation
Access to remote endpoint data collection
Defense evasion techniques - Malware defense evasion and detection
Understanding core Windows processes
Persistence - Malware persistence detection and analysis
Finding and Analyzing Malicious WMI Event Consumers
CPE/CMU Credits: 6

Topics
Real Incident Response Tactics
Preparation: Key tools, techniques, and procedures that an incident response team needs to respond properly to intrusions
Identification/Scoping: Proper scoping of an incident and detecting all compromised systems in the enterprise
Containment/Intelligence Development: Restricting access, monitoring, and learning about the adversary in order to develop threat intelligence
Eradication/Remediation: Determining and executing key steps that must be taken to help stop the current incident
Recovery: Recording of the threat intelligence to be used in the event of a similar adversary returning to the enterprise
Avoiding "Whack-A-Mole" Incident Response: Going beyond immediate eradication without proper incident scoping/containment
Threat Hunting
Hunting versus Reactive Response
Intelligence-Driven Incident Response
Building a Continuous Incident Response/Threat Hunting Capability
Forensic Analysis versus Threat Hunting across endpoints
Threat Hunt Team Roles
ATT&CK - MITRE's Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK(TM))
Threat Hunting in the Enterprise
Identification of Compromised Systems
Finding Active and Dormant Malware
Digitally Signed Malware
Malware Characteristics
Common Hiding Mechanisms
Finding Evil by Understanding Normal
Understanding Common Windows Services and Processes
svchost.exe Abuse
Incident Response and Hunting across Endpoints
WMIC & PowerShell
Incident Response and Hunting Endpoint Collection with Kansa
Malware Defense Evasion and Identification
Service Hijacking/Replacement
Frequent Compilation
Binary Padding
Packing/Armoring
Dormant Malware
Signing Code with Valid Cert
Anti-Forensics/Timestomping
Malware Persistence Identification
AutoStart Locations, RunKeys
Service Creation/Replacement
Service Failure Recovery
Scheduled Tasks
DLL Hijacking
WMI Event Consumers
More Advanced - Local Group Policy, MS Office Add-In, or BIOS Flashing
Investigating WMI-Based Attacks
WMI Overview
WMI Attacks Across the Kill Chain
Auditing the WMI Repository
WMI File System and Registry Residue
Command-Line Analysis and WMI Logs
WMI Process Anomalies


--Even the most advanced adversaries leave footprints everywhere. Learn the secrets of the best hunters.

Cyber defenders have a wide variety of tools and artifacts available to identify, hunt, and track adversary activity in a network. Each attacker action leaves a corresponding artifact, and understanding what is left behind as footprints can be critical to both red and blue team members. Attacks follow a predictable pattern, and we focus our detective efforts on immutable portions of that pattern. As an example, at some point an attacker will need to run code to accomplish its objectives. We can identify this activity via application execution artifacts. The attacker will also need one or more accounts to run code. Consequently, account auditing is a powerful means of identifying malicious actions. An attacker also needs a means to move throughout the network, so we look for artifacts left by the relatively small number of ways there are to accomplish this part of their mission. In this section, we cover common attacker tradecraft and discuss the various data sources and forensic tools you can use to identify malicious activity in the enterprise.

Exercises
Hunting and detecting evidence of execution with Shimcache and Amcache
Prefetch carving and extraction from memory and unallocated space
Discovering credential abuse with event log extraction and analysis
Tracking lateral movement with event log analysis
Hunting malicious use of WMI and PowerShell
CPE/CMU Credits: 6

Topics
Stealing and Utilization of Legitimate Credentials
Pass the Hash
Single Sign On (SSO) Dumping using Mimikatz
Token Stealing
Cached Credentials
LSA Secrets
Kerberos Attacks
NTDS.DIT theft
Advanced Evidence of Execution Detection
Attacker Tactics, Techniques, and Procedures (TTPs) overserved through process execution
Prefetch Recovery and Analysis
Application Compatibility Cache (ShimCache)
Amcache Registry Examination
Lateral Movement Adversary Tactics, Techniques, and Procedures (TTPs)
Compromising Credentials Techniques
Remote Desktop Services Misuse
Windows Admin Share Abuse
PsExec Utilization
Windows Remote Management Tool Techniques
PowerShell Remoting/WMIC Hacking
Vulnerability Exploitation
Log Analysis for Incident Responders and Hunters
Profiling Account Usage and Logons
Tracking and Hunting Lateral Movement
Identifying Suspicious Services
Detecting Rogue Application Installation
Finding Malware Execution and Process Tracking
Capturing Command Lines and Scripts
Powershell Transcript and ScriptBlock Logging
PowerShell Script Obfuscation
WMI Activity Logging
Anti-Forensics and Event Log Clearing


During an intrusion, using memory analysis sometimes feels like cheating - finding active attacks shouldn't be this easy.

Now a critical component of many incident response and threat hunting teams who regularly detect advanced adversaries in their organization, memory forensics has come a long way in just a few years. Memory forensics can be extraordinarily effective at finding evidence of worms, rootkits, PowerShell, and advanced malware used by APT attackers. In fact, some attacks may be nearly impossible to unravel without memory analysis. Memory analysis was traditionally the domain of Windows internals experts, but the recent development of new tools and techniques makes it accessible today to all investigators, incident responders, and threat hunters. Better tools, interfaces and detection heuristics have greatly leveled the playing field. Understanding attack patterns in memory is a core analyst skill applicable across a wide range of endpoint detection and response (EDR) products. This extremely popular section will cover many of the most powerful memory analysis capabilities available and give you a solid foundation of advanced memory forensic skills to super-charge investigations, regardless of the toolset employed.



Exercises
Remote endpoint incident response, hunting, and analysis using F-Response Enterprise
Remote endpoint memory examination using F-Response Enterprise
Creating triage images with KAPE
Detect unknown live and dormant custom malware in memory across multiple systems in an enterprise environment
Examine Windows process trees to identify normal versus anomalies
Find APT "beacon" malware over common ports used by targeted attackers to access command and control (C2) channels
Find residual attacker command-line activity through scanning strings in memory and by extracting command history buffers
Compare compromised system memory against a baseline system using Frequency of Least Occurrence stacking techniques
Identify advanced malware hiding techniques, including code injection and rootkits
Employing indicators of compromise to automate analysis
Analysis of memory from infected systems:
Stuxnet
TDL3/ TDSS
Cozyduke RAT
Rundll32
Zeus/Zbot
Conficker
Sobig
StormWorm Rootkit
Black Energy Rootkit
WMI and PowerShell
Cobalt Strike Beacons
Custom APT command and control malware
CPE/CMU Credits: 6

Topics
Remote and Enterprise Incident Response
Remote Endpoint Access in the Enterprise
RemoteEndpoint Host-based Analysis
Scalable Host-based Analysis (one analyst examining 1,000 systems) and Data Stacking
Remote Memory Analysis
Triage and Enpoint Detection and Reponse (EDR)
Endpoint Triage Collection
EDR Capabilities and Challenges
EDR and Memory Forensics
Memory Acquisition
Acquisition of System Memory from both Windows 32/64 Bit Systems
Hibernation and Pagefile Memory Extraction and Conversion
Virtual Machine Memory Acquisition
Memory changes in Windows 10
Windows 10 Virtual Secure Mode
Memory Forensics Analysis Process for Response and Hunting
Identify Rogue Processes
Analyze Process DLLs and Handles
Review Network Artifacts
Look for Evidence of Code Injection
Check for Signs of a Rootkit
Acquire Suspicious Processes and Drivers
Memory Forensics Examinations
Live Memory Forensics
Advanced Memory Analysis with Volatility
Webshell Detection Via Process Tree Analysis
Code Injection, Malware, and Rootkit Hunting in Memory
WMI and PowerShell Processes
Extract Typed Adversary Command Lines
Investigate Windows Services
Hunting Malware Using Comparison Baseline Systems
Find and Dump Cached Files from RAM
Memory Analysis Tools
Volatility
Rekall & Google Rapid Response
Comae Windows Memory Toolkit

Timeline analysis will change the way you approach digital forensics, threat hunting, and incident response...forever.


Learn advanced incident response and hunting techniques uncovered via timeline analysis directly from the authors who pioneered timeline analysis tradecraft. Temporal data are located everywhere on a computer system. Filesystem modified/access/creation/change times, log files, network data, registry data, and Internet history files all contain time data that can be correlated into critical analysis to successfully solve cases. Pioneered by Rob Lee in 2001, timeline analysis has become a critical incident response, hunting, and forensics technique. New timeline analysis frameworks provide the means to conduct simultaneous examinations of a multitude of time-based artifacts. The analysis that once took days now takes minutes.

This section will step you through the two primary methods of building and analyzing timelines created during advanced incident response, threat hunting, and forensic cases. Exercises will show analysts how to create a timeline and also how to introduce the key methods to help you use those timelines effectively in your cases.



Exercises
Using timeline analysis, track adversary activity by hunting an APT group's footprints of malware, lateral movement, and persistence
Target hidden and time-stomped malware and utilities that an APTuses to move in the network and maintain its presence
Track APT activity second-by-second through in-depth super-timeline analysis
Observe targeted attackers laterally move to other systems in the enterprise by watching a trail left in filesystem times, registry, Shimcache, and other temporal-based artifacts
Learn how to filter system artifact, file system, and registry timelines to target specific data efficiently
CPE/CMU Credits: 6

Topics
Timeline Analysis Overview
Timeline Benefits
Prerequisite Knowledge
Finding the Pivot Point
Timeline Context Clues
Timeline Analysis Process
Memory Analysis Timeline Creation
Memory Timelining
Filesystem Timeline Creation and Analysis
MACB Meaning by Filesystem
Windows Time Rules (File Copy versus File Move)
Filesystem Timeline Creation Using Sleuthkit and fls
Bodyfile Analysis and Filtering Using the mactime Tool
Super Timeline Creation and Analysis
Super Timeline Artifact Rules
Program Execution, File Knowledge, File Opening, File Deletion
Timeline Creation with log2timeline/Plaso
log2timeline Input Modules
log2timeline Output Modules
Filtering the Super Timeline Using psort
Targeted Super Timeline Creation
Automated Super Timeline Creation
Super Tmeline Analysis
Volume Shadow Copy Timelining

Advanced adversaries are good. We must be better.


Over the years, we have observed that many incident responders and threat hunters have a challenging time finding threats without pre-built indicators of compromise or threat intelligence gathered before a breach. This is especially true in APT adversary intrusions. This advanced session will demonstrate techniques used by first responders to identify malware or forensic artifacts when very little information exists about their capabilities or hidden locations. We will discuss techniques to help funnel possibilities down to the candidates most likely to be evil malware trying to hide on the system.




Exercises
Find unknown malware across your enterprise by looking for dormant and active malware traces
Cyber threat intelligence - Indicator creation and examination
Understand how an APT group can acquire domain admin rights in a locked-down environment
CPE/CMU Credits: 6

Topics
Cyber Threat Intelligence
Importance of Cyber Threat Intelligence
Understanding the "Kill Chain"
Threat Intelligence Creation and Use During Incident Response and Threat Hunting
Creation of Indicators of Compromise
Incident Response Team Life-Cycle Overview
Malware and Anti-Forensic Detection
NTFS Filesystem Analysis
Master File Table (MFT) Critical Areas
NTFS System Files
NTFS Metadata Attributes ($Standard_Information, $Filename, $Data)
Rules of Windows Timestamps for $StdInfo and $Filename
Timestomp detection via NTFS Timestamp Analysis
Resident versus Nonresident Files
Hidden data in Alternate Data Streams
Finding Wiped/Deleted Files using Directory Listings and the $I30 file
Filesystem Flight Recorders: Transaction Logging and the $Logfile and $UsnJrnl
What Happens When Data Is Deleted from an NTFS Filesystem?
Anti-Forensic Detection Methodologies
MFT Anomalies
Timeline Anomalies
Deleted File
Deleted Registry Keys
File Wiping
Adjusting Timestamps
Identifying Compromised Hosts without Active Malware
Rapid Data Triage Analysis
Cyber Threat Intelligence and Indicators of Compromise Searching
Evidence of Persistence
Super-timeline Examination
Packing/Entropy/Executable Anomaly/Density Checks
System Logs
Memory Analysis
Malware Identification

This incredibly rich and realistic enterprise intrusion exercise is based on a real-world advanced persistent threat (APT) group. It brings together techniques learned earlier in the course and tests your newly acquired skills in an investigation into an attack by an advanced adversary. The challenge brings it all together using a real intrusion into a complete Windows enterprise environment. You will be asked to uncover how the systems were compromised in the initial intrusion, find other compromised systems via adversarylateral movement, and identify intellectual property stolen via data exfiltration. You will walk out of the course with hands-on experience investigating a real attack, curated by a cadre of instructors with decades of experience fighting advanced threats from attackers ranging from nation-states to financial crime syndicates and hactivist groups.

CPE/CMU Credits: 6

FOR508.6: The APT Threat Group Incident Response Challenge
Topics
The Intrusion Forensic Challenge will ask each incident response team to analyze multiple systems in an enterprise network with many endpoints.
During the challenge, each incident response team will be asked to answer key questions and address critical issues in the different categories listed below, just as they would during a real breach in their organizations:
IDENTIFICATION AND SCOPING:

1. How and when did the APT group breach our network?

2. List all compromised systems by IP address and specific evidence of compromise.

3. When and how did the attackers first laterally move to each system?


CONTAINMENT AND THREAT INTELLIGENCE GATHERING:

4. How and when did the attackers obtain domain administrator credentials?

5. Once on other systems, what did the attackers look for on each system?

6. Find extracted email from executive accounts and perform damage assessment.

7. Determine what was stolen: Recover any archives exfiltrated, find encoding passwords, and extract the contents to verify extracted data.

8. Collect and list all malware used in the attack.

9. Develop and present security intelligence and host and network based indicators of compromise describing attacker tradecraft.

REMEDIATION AND RECOVERY:

10. What level of account compromised occurred. Is a full password reset required during remediation?

11. Based on the attacker techniques and tools discovered during the incident, what are the recommended steps to remediate and recover from this incident?

a. What systems need to be rebuilt?

b. What IP addresses need to be blocked?

c. What countermeasures should we deploy to slow or stop these attackers if they come back?

d. What recommendations would you make to detect these intruders in our network again?



# SEC401: Security Essentials Bootcamp Style	GSEC	Ross Bergman #

Learn the most effective steps to prevent attacks and detect adversaries with actionable techniques that you can directly apply when you get back to work. Learn tips and tricks from the experts so that you can win the battle against the wide range of cyber adversaries that want to harm your environment.

Is SEC401: Security Essentials Bootcamp Style the right course for you?

STOP and ask yourself the following questions:

Do you fully understand why some organizations get compromised and others do not?
If there were compromised systems on your network, are you confident that you would be able to find them?
Do you know the effectiveness of each security device and are you certain that they are all configured correctly?
Are proper security metrics set up and communicated to your executives to drive security decisions?
If you do not know the answers to these questions, then SEC401 will provide the information security training you need in a bootcamp-style format that is reinforced with hands-on labs.

SEC401.1 Network Security Essentials - Module Outline

Defensible Network Architecture
Virtualization and Cloud Security
Lab Virtual Machine Setup
Network Device Security
Networking and Protocols
Lab - tcpdump
Securing Wireless Networks
Lab - Aircrack-ng
Securing Web Communications
Lab -Wireshark
Module 1: Defensible Network Architecture

Involves the fundamentals of network architecture, including network architecture, attacks against network devices, network topologies and network design.

Network Architecture: Understand and identify the goals of building a defensible network architecture
Understanding the Architecture of the System
Conceptual Design
Logical Design
Physical Design
Understand Communication Flow
Know Where Your Valuable Data is
Attacks Against Network Device: Understand and identify the common types of attacks against networks
Networks Under Attack
Threat Enumeration
Threat Agents
Attacks Against Routers
Attacks against switches
Network Topologies: Understand and know the different types of topologies and the inherent security risks they create
Physical and Logical Topologies
Ethernet
Network Design
Approaches to Network Design
Network Design: Understanding and knowing how to design a secure network that incorporates both prevention and detection
Approaches to Network Design
Network Architecture Design
Network Design Objectives
Network Sections
Module 2: Virtualization and Cloud Security

Involves understanding and learning what virtualization is and how it works, the most common form of virtualization and how virtual machines interact with multiple operating systems.

Virtualization
Setting Up Virtualization
Virtualization Security
Virtualized Architectures
Cloud Overview
Cloud Security
Lab 1.1: Virtual Machine Setup: The purpose of this lab is to learn how to set up Windows and Linux virtual machines in a lab-based environment and understanding the fundamentals of the operating systems and how to run basic commands. Completing the lab, you will learn:
Copy and extract the SANS-supplied Windows 10 virtual machine and the Kali Linux virtual machine to your hard drive
Start the virtual machines with VMware Workstation, Player, or Fusion if on a Mac
Configure your Windows 10 licensing
Verify network connectivity between the two virtual machines
Module 3: Network and Device Security

Involves understanding the different devices that are deployed on a network and how they function.

Network Devices
Routing
How Routing Works
Device Security
Module 4: Networking and Protocols

Involves understanding the properties and functions of network protocols and the network protocol stacks

Network Protocols
Layer 3
Internet Protocol (IP)
Internet Control Message Protocol (ICMP)
Layer 4
Transmission Control Protocol (TCP)
User Datagram Protocol (UDP)
tcpdump
Lab1.2: tcpdump: The purpose of this lab is to learn how to use Kali and run a sniffer and understand how to decode packets. You will learn,
Introduction to tcpdump and basic commands
Running tcpdump and sniffing network traffic
Analyzing hex and ASCII data
Connecting to a non-listening TCP port
Module 5: Securing Wireless Networks

Involves the aspect of deploying and utilizing wireless networks. Student will understand wireless technologies.

Wireless overview
Bluetooth and ZigBee
802.11
Wireless security
Lab1.3: Aircrack-ng: In the lab, you will use the aircrack-ng tool suite to assess the security of both the Wired Equivalent Privacy (WEP) security algorithm and Wi-Fi Protected Access (WPA) protocol associated with 802.11 wireless network security. You will learn:
Introduction to the aircrack-ng suite
Cracking a WEP key
Cracking a WPA2 passphrase
Module 6: Securing Web Communications

Involves understanding how web applications work. Learn best practices for creating secure web applications and how to identify and fix vulnerabilities in web applications.

How Web Applications Work
Basics of Secure Coding
Web Application Vulnerabilities
Lab 1.4: WireShark: In this lab, you will learn how to use Wireshark and understand how to analyze packets.
Introduction to Wireshark and its GUI
Basic capture of an FTP connection
Analysis of a TFTP session

You Will Learn:

To develop effective security metrics that provide a focused playbook that IT can implement, auditors can validate, and executives can understand
To analyze and assess the risk to your environment in order to drive the creation of a security roadmap that focuses on the right areas of security
Practical tips and tricks to focus in on high-priority security problems within your organization and on doing the right things that will lead to security solutions that work
Why some organizations are winning and some are losing when it comes to security and, most importantly, how to be on the winning side
The core areas of security and how to create a security program that is anchored on PREVENT-DETECT-RESPOND.
Learn to build a security roadmap that can scale today and into the future.

SEC401: Security Essentials Bootcamp Style is focused on teaching you the essential information security skills and techniques you need to protect and secure your organization's critical information assets and business systems. Our course will show you how to prevent your organization's security problems from being headline news in the Wall Street Journal!

"Prevention is Ideal but Detection is a Must."

With the rise in advanced persistent threats, it is almost inevitable that organizations will be targeted. Whether the attacker is successful in penetrating an organization's network depends on the effectiveness of the organization's defense. Defending against attacks is an ongoing challenge, with new threats emerging all of the time, including the next generation of threats. Organizations need to understand what really works in cybersecurity. What has worked, and will always work, is taking a risk-based approach to cyber defense. Before your organization spends a dollar of its IT budget or allocates any resources or time to anything in the name of cybersecurity, three questions must be answered:

What is the risk?
Is it the highest priority risk?
What is the most cost-effective way to reduce the risk?
Security is all about making sure you focus on the right areas of defense. In SEC401 you will learn the language and underlying theory of computer and information security. You will gain the essential and effective security knowledge you will need if you are given the responsibility for securing systems and/or organizations. This course meets both of the key promises SANS makes to our students: (1) You will learn up-to-the-minute skills you can put into practice immediately upon returning to work; and (2) You will be taught by the best security instructors in the industry.

# SEC487: Open-Source Intelligence (OSINT) Gathering and Analysis	Micah Hoffman#
—
We begin with the basics and answer the questions "what is OSINT" and "how do people use it." This first day is about level-setting and ensuring that all students understand the background behind what we do in the OSINT field. We also establish the foundation for the rest of the week by learning how to document findings and set up an OSINT platform, and we discuss effective research habits for OSINT analysts. This day is a key component for the success of an OSINT analyst because without these concepts and processes in place, researchers can get themselves into serious trouble during assessments by inadvertently alerting their targets or improperly collecting data, making them less useful when delivered to the customer.

During the first half of the day we work through the pieces of the OSINT cycle to understand what our process might look like. Then we move into how law-abiding people use OSINT to get the data they need, be it parents trying to figure out if the person they want to hire as a child care worker is trustworthy, a person "googling" someone they are going out with on a date, businesses looking for information about a rival company, or law enforcement using social media and OSINT to capture criminals. We then move into how criminals use OSINT to target victims and conduct other attacks against people and their electronic data. We finish the morning with a review of documentation tools for creating MindMaps, compiling notes, creating timelines, and analyzing relationships within data.

The day continues by jumping into understanding threat profiles so that we can protect ourselves and infiltrate the places we need to gather the data our customers want. Recognizing that some students will be creating their own OSINT collection platforms, we move into what that may look like, covering topics such as the platform, operating system, networks, tools, and plugins. At the end of the day, students learn about the use of sock puppet (false accounts) and set up their own account for the labs in the course.

CPE/CMU Credits: 6

Topics
Understanding OSINT
The OSINT cycle
Goals of OSINT Collection
Law enforcement
Parents
Spouses
Businesses
Media
Intelligence agencies
Criminals
Diving into Collecting
How just "diving" into an assessment can cause problems
Case study
Taking Excellent Notes
Why good note-taking is important
How to document
Tools to document
Visualization
Note-taking applications
Documentation application/Hunchly
Word processing
Taking screenshots
Timelines
Determining Your Threat Profile
How "covert" do you need to be?
Methods that may reveal what OSINT is doing to a target
Setting Up an OSINT Platform
Types of platforms
Virtual machine (VM)
USB media
Cloud server
Networking and VPNs
Web browsers
Useful extensions and add-ons
Data at rest
Mobile OSINT
Password management
Effective Research Habits
Engaging your target
Sensitive data
Sanitizing your platform
Managing your time
Being disciplined
Creating Sock Puppets
What is a sock puppet?
Why do we use them?

OSINT data collection begins on day two after we get a glimpse of some of the fallacies that could influence our conclusions and recommendations. From this point in the class forward, we examine distinct categories of data and think about what it could mean for our investigations. Retrieving data from the Internet could mean using a web browser to view a page or, as we learn in this section, using command line tools, scripts, and helper applications.

Our focus for day 2 begins with creating an OSINT assessment process and examining several OSINT frameworks that will help us while conducting our assessments. We then move to harvesting data from and about websites. Analyzing data such as SSL/TLS certificates and Google analytics IDs can be important to our assessments. Shifting from systems to people, we examine different methods for finding and validating basic data about people such as home addresses, phone numbers, and email addresses. These pieces of data become "pivot points" for our investigations, as we can often perform additional searches using these key data points to discover additional data that may be useful in our work. Students learn how to harvest user names and avatars and how they tie a single user to multiple user profiles across sites.

With user avatar images fresh in our minds, we pivot and consider how to perform reverse image searches. Day two concludes with a deep look at how we can execute advanced search engine queries to increase our chances of getting meaningful results.

CPE/CMU Credits: 6

Topics
Data Analysis Challenges
Inaccurate data
Bias
Analysis fallacies
Creating Your OSINT Process
Start with a clean system
Gathering requirements
Decide on TTPs
Gathering data
Analyzing data
Creating output for customer
Harvesting Web Data
Proxy web applications
Command line tools for harvesting data
Scripting with Python
APIs
Cached content
Google Analytics
Encryption certificates
OSINT Frameworks
PTES
Advanced Recon Framework (ARF)
OSINT Start.me pages
Additional OSINT web resources
Basic Data: Street Addresses
Why gather street addresses?
Places you can find street addresses
Online newsletters
Real estate sites
Basic Data: Phone Numbers
Reverse phone look-ups
Places you can find phone numbers
Removing personal data
Basic Data: Email Addresses
Places you can gather email addresses
Email formats
Email validation
Gathering emails in bulk
User Names
Understanding why we collect user names
Websites and tools that can be used to harvest user names
Social media account aggregation sites
Avatars and Reverse Image Searches
Why avatars are interesting to OSINT
Image search engines
Leveraging Search Engines
Detailed examination of how to use several search engines for OSINT
Advanced queries and directives
Google dorks and Google Hacking database

Finding data on people, especially basic content such as email addresses, home addresses, and phone numbers, can be made easier using online people search engines. This is how day three kicks off, examining free and paid choices in this data aggregator area and understanding how to use the data we receive from them. Some of these engines provide social media content in their results. This makes a terrific transition for us to move into social media data.

The first social media site we look at from an OSINT perspective is Facebook, with its worldwide reach. Students explore Facebook profiles, groups, events, and other Facebook objects using graph searches and Facebook query techniques. We then move to detailed examinations of LinkedIn, Twitter, and Instagram, and what OSINT data can be found in each of them.

An increasing number of social media sites allow users to geolocate themselves. The afternoon of day 3 starts with an examination of how to harvest and use this content for OSINT. Then, focusing on the "social" aspect of social media, we dive into the content on dating and adult websites. A natural progression from dating is sometimes a wedding, so we inspect wedding websites and registries for OSINT data. Next, we see how we can use web and traffic cameras for remote reconnaissance. We finish the day by examining document and image metadata to glean interesting data points from different document types.

CPE/CMU Credits: 6

Topics
People Searching
Free people search engines
Paid consumer-level search engines
Commercial aggregators
Family trees
Obituaries
Facebook Analysis
Facebook primer
Intro to graph search
Websites that make searching Facebook easier
Crafting custom graph searches
Finding intersections and relationships
Gathering business data
LinkedIn Data
OSINT value of LinkedIn
Data that can be gleaned from LinkedIn
Instagram
OSINT value of Instagram
Retrieving data from Instagram with custom URLs
Instagram API
Twitter Data
OSINT value of Twitter
Searching Twitter
Tweet content analysis
Twitter geolocation
Deleted tweets
Gathering data from protected accounts
Geolocation
OSINT value of geolocation
Faking GPS locations
Analysis of social media systems that geolocate users
Geolocation discovery tools
Dating and Adult Websites
Harvesting data from dating and adult site user profiles
Registries and Wish Lists
OSINT value of registries and wish lists
Finding registries and wish lists
Web and Traffic Cameras
Reliable web and traffic camera sites
Leveraging these cameras in assessments
File Metadata Analysis
What is metadata?
How do we use it?
How do we retrieve it?


Day four focuses on many different but related OSINT issues. We begin by looking at how various mapping sites can assist our assessments with aerial data, distance-measuring, and "street view" imagery. Moving beyond using just one vendor's mapping system, students will work with a variety of free, online mapping resources.

We then shift from OSINT about people and locations to OSINT about networks and computers, as researching IP addresses, domain names, and related content can be important aspects of our investigations. Starting with the basics, we get comfortable retrieving information about IP addresses, network blocks, and using the whois protocol. Students then move to making advanced queries to the domain name system (DNS) to grab subdomains and other domain data. To complete our work looking at computers, we examine how we use wireless network data in our work.

The second portion of the day has three modules. The first covers OSINT framework tool suites. These tools can accelerate our OSINT research by very rapidly acquiring data about people, networks, hosts, and more. We examine three frameworks in-depth during class. The next module covers harvesting information from federal, state, and local government web pages within the United States. The public data on these sites can help us research people and businesses. Completing the day, we look at the methods that can be used to gather data about businesses.

CPE/CMU Credits: 6

Topics
Remote Location Recon
Satellite and aerial imagery
Ground-based imagery (commercial and consumer)
Using mapping tools to measure data and markup maps
Using historical ground-based imagery
IP Address and Whois
Basic introduction of computer networking concepts
Leveraging the Whois protocol for OSINT
IP Address Geolocation
Accuracy of IP address geolocation
How to geolocate from an IP address
Domain Name System (DNS)
Description of DNS
DNS data
Tools to harvest data from DNS servers
Wireless Networks
Searching wireless network data
Recon Tool Suites and Frameworks
Detailed comparison of three reconnaissance frameworks
SpiderFoot
Intrigue
Recon-ng
U.S. Government Data
Federal resources
State and local government resources
Researching Companies
Retrieving basic data about businesses
Business profile sites
Non-profit and charity organization OSINT
Business filings/EDGAR
International business OSINT
Management analysis
Business systems analysis
Censys.io
Shodan.io

The entire morning of day five focuses on understanding and using three of the most popular dark web networks for OSINT purposes. Students will learn why people use Freenet, I2P, and Tor. Each network is discussed at length so that students don't just know how and why to use it, but also gain an understanding of how those networks work. With the Tor network being such a big player in the dark web, the course spends extra time diving into its resources.

The first module in the afternoon examines how blue teamers (cyber defenders) can use monitoring to receive alerts when data of interest appears on the Internet. We then shift our focus to data found on "paste" sites. These websites sometimes contain content such as user names and passwords of compromised user accounts, detailed network information about our target's systems, or just data that our customers need to know.

Considering that a big barrier to using non-English websites can be the language, students learn how to use techniques to translate content and search locally for relevant information in our international OSINT section. We also examine how to discover popular websites and applications used in foreign countries. Since we talk about international data and traveling around the world, our courseware finishes up with an examination of how we track transportation (planes, boats, cars, etc.).

We leave some time at the end of the day for a massive lab, the "Solo CTF," which helps students put together all that they have learned in a semi-guided walk-through that touches on many of the concepts taught throughout the week. Setting aside time to work through our OSINT process in an organized manner reinforces key concepts and allows students to practice executing OSINT process, procedures, and techniques.

CPE/CMU Credits: 6

Topics
The Surface, Deep, and Dark Webs
Levels of the Internet
Understanding of what data are at what layer and how to access them
The Dark Web
Risks in using the dark web
Overview of top three dark web networks
Freenet
Modes of Freenet
Accessing Freenet
Services and resources in the Freenet
I2P - Invisible Internet Project
What data are in I2P?
I2P tunnels
Using I2P
Eepsites
Tor
Who uses Tor and why?
How Tor works
Cautions when using Tor
Accessing Tor
Tor hidden services
Scanning and monitoring Tor hidden services
Sharing files in Tor
Monitoring and Alerting
Performing searches in HaveIBeenPwned.com using web and API
Setting up alerts to monitor web content
Creating web dashboards
What do people use paste sites for?
Harvesting content from paste sites
Google Custom Search Engines
International Issues
Language translation tools
Popular websites
Popular mobile applications
Searching regionally
Vehicle Searches
License plates
Vehicle ID Numbers (VINs)
Plane registrations
Plane tracking
Ships and watercraft
Putting it all together

 SEC487.6: Capstone: Capture (and Present) the Flag
The capstone for the course is a group event that brings together everything that students learned throughout the week. This is not a "canned" Capture the Flag event where specific flags are planted and your team must find them. It is a competition where each team will collect specific OSINT data about a certain group of people. The output from this work will be turned in as a "deliverable" to the "client" (the instructor), and then the three teams with the most-complete work will present their research to the class for voting.

This multi-hour, hands-on event will reinforce what the students practiced in the Solo CTF the day before and add the complexity of performing OSINT assessments under pressure and in a group.

# SEC501: Advanced Security Essentials - Enterprise Defender	GCED	Bryce Galbraith #

# SEC503: Intrusion Detection In-Depth	GCIA	Andrew Laman #

Course Syllabus and Course Contents

Day 1/2: Fundamentals of Traffic Analysis

Why you should capture and be able to analyze packets
Understanding bits, bytes, binary, and hexadecimal
TCP/IP concepts
Using tcpdump and Wireshark and their filtering techniques
Link layer, IPv4, IPv6, and fragmentation
Transport layers TCP, UDP, and ICMP
Day 3: Application Protocols

Scapy
HTTP
SMTP
Microsoft protocols
DNS
IDS evasions
Day 4: Network Monitoring: Signatures vs. Behaviors

Architecture for network monitoring
Running, installing, configuring, and customizing Snort
Writing Snort rules
Running, installing, configuring, and customizing Bro
Writing Bro scripts and signatures, and raising Bro notices
Day 5: Network Traffic Forensics

Hands-on experience analyzing incident scenarios
Data-driven analysis vs. alert-driven reactions
Hypothesis and visualization for large-scale network analysis
Using SiLK as open-source network flow records to expose network behavior anomalies
Understanding and detecting covert channels
Analyzing large pcap files
Identifying C2 activities
Practical analysis of TLS data
Day 6: Advanced IDS Capstone Event

Collaborate with fellow students to compete in a NetWars-like IDS-specific challenge
You Will Learn

How to analyze traffic traversing your site to avoid becoming another "Hacked!" headline
How to identify potentially malicious activities for which no IDS has published signatures
How to place, customize, and tune your IDS/IPS for maximum detection
Hands-on detection, analysis, and network forensic investigation with a variety of open-source tools
TCP/IP and common application protocols to gain insight about your network traffic, enabling you to distinguish normal from abnormal traffic
The benefits of using signature-based, flow, and hybrid traffic analysis frameworks to augment detection

SEC401.2 Defense-In-Depth and Attacks -Module Outline

Defense-in-Depth
Access Control & Password Management
Lab - John the Ripper
Security Policies
Lab - Cain & Abel
Critical Controls
Malicious Code and Exploit Mitigations
Lab - Malicious Software
Advanced Persistent Threat (APT)
Module 7: Defense-in-Depth

Involves understanding what defense in depth is and an overview of the key areas of security.

Defense-in-Depth Overview
Risk = Threats x Vulnerabilities
CIA Triad
Strategies for Defense in Depth
Core Security Strategies
Module 8: Access Control & Password Management: Involves understanding understand the fundamental theory of access control

Access control
Data classification
Managing access
Separation of duties
Password management
Password management technologies
How password assessment works
Lab 2.1 - John the Ripper: In this lab students will perform a lab using John the Ripper, a widely-used password cracking tool, which was covered in the module. Completing the lab, you will learn:
Introduction to John the Ripper and its various components
Cracking passwords with John the Ripper
Module 9: Security Privacy

Involves the understanding on how to assess a policy by establishing a baseline framework to work within, and by establishing a mission statement that defines your policies.

Security Policies
Need for policies
Policy Framework
Enforcement
Lab 2.2 - Cain & Abel: This lab is designed to help learn how to use a multi-purpose tool like Cain & Abel and understand the fundamentals of auditing the strength of passwords. In this lab, you will learn:
Introduction to Cain & Abel and its GUI
Extracting and cracking passwords from your Windows 10 SAM database
Cracking a password from a Cisco Router
Module 10: Critical Security Controls

Involves understanding the purpose and background of the Critical Security Controls.

Overview of the Critical Security Controls
The Critical Security Controls
Sample Critical Security Control
Module 11: Malicious Code and Exploit Mitigation

Involves understanding the details of the Mitnick-Shimomura attack, as well as what we can learn from this attack to appropriately protect our networks against these threats.

Mitnick-Shimomura
Defensive strategies
Common types of attacks
Lab 2.3 - Malicious Software: In this lab, you will learn how to defend against malicious software understand the operations of malicious software. You will also learn:
Analyzing the non-trojaned program
Analyzing the trojaned program and gaining privileged access
Checking for a buffer overflow
Module 12: Advanced Persistent Threat (APT)

Involves learning the new threats that exist in cyberspace and effective ways for dealing with these threats. Students will also understand what an APT is and the basic strategies of how they work and operate.

What are APTs and why are they so hard to manage?
Defending Against an APT
How can cyber remediation be approached?
Offensive Operations

SEC401.3 Threat Management - Module Outline

Vulnerability Scanning and Penetration Testing
Lab - nmap
Network Security Devices
Lab - Snort
Endpoint Security
Lab -hping
SIEM/log management
Active Defense
Lab - Command Injection
Module 13: Vulnerability Scanning and Penetration Testing

Involves understanding the concepts and relationships behind reconnaissance, resource protection, risks, threats and vulnerabilities.

Vulnerability management overview
Network scanning
Penetration Testing
Lab 3.1 - Nmap: The purpose of this lab is to identify open ports on a system and understand the operations of port-scanning software. Completing the lab, you will learn:
Introduction to Nmap and its features
Port scanning with Nmap
OS and application version scanning
Nmap Scripting Engine (NSE)
Module 14: Network Security Devices

Involves taking a look at the 3 main categories of network security devices: firewalls, NIDS and NIPS. Together they provide a complement of prevention and detection capabilities.

Firewalls
Overview
Types of Firewalls
Configuration and Deployment
NIDS
Types of NIDS
Snort as an NIDS
NIPS
Methods of Deployment
Lab 3.2: Snort: In this lab, you will learn how to run and configure Snort and understand how to utilize an IDS to detect attacks. Area's within the lab are:
Introduction to Snort and its features
Running Snort and triggering an alert
Reviewing Snort logs and the matched signatures
Module 15: Endpoint Security

Involves understanding the overall importance and concepts of endpoint security. This module, we will examine some of the key components, strategies, and solutions for implementing endpoint security.

Endpoint Security Overview
Endpoint Security Solutions
HIDS Overview
HIPS Overview
Lab 3.3 - hping 3: This lab teaches you how to craft packets and understand packet-creation software. Area's in the lab are:
Introduction to hping 3 and its features
Crafting packets with hping 3
Spoofing IP addresses with hping 3
Module 16: SIEM/Log Management

Involves student being able to obtain a high-level understanding of what logging is and why it is important. The student will also know have a high-level understanding of what logging is and why it is important.

Logging Overview
Setting Up and Configuring Logging
Logging Analysis Basics
Key Logging Activity
Module 17: Active Defense

Involves explaining what active defense is and how it can be used. You will get an appreciation for new ways to approach security and how to make your defensive solutions more active.

Defining Active Defense
Active Defense Techniques
Active Defense Tools
Honeypots & Active Defense
Lab 3.4 - Command Injection: In this lab, you will Learn how to perform command injection and understand how attacks work and operate. Completing the lab, you will understand:
Normal operation
Injecting a command to break out of a restriction

SEC401.4 Cryptography, Risk Management and Response - Module Outline

Cryptography
Lab - Stego
Cryptography Algorithms and Deployment
Applying Cryptography
Lab - GPG
Incident Handling and Response
Lab - Hashing
Contingency Planning - BCP/DRP
IT Risk Management
Module 18: Cryptography

Involves students having a basic understanding of the fundamental concepts of cryptography

Overview of Cryptology
Plaintext, Ciphertext, and Key
Types of Symmetric Encryption
Symmetric Encryption
Asymmetric Encryption
Hash
Lab 4.1 - Image Steganography: In this lab, you will understand the operations of data hiding program and learn how to utilize steganography programs. The topics will be:
Learn how to utilize steganography programs
Module 19: Cryptography Algorithms and Deployment

Involves students having a high-level understanding of the mathematical concepts that contribute to modern cryptography

Crypto Concepts
Symmetric and asymmetric cryptosystems
Crypto attacks
Module 20: Applying Cryptography

Involves having a high-level understanding of what VPNs are and how they operate. Students will also understand the functionality of the GPG cryptosystem and how they operate.

Data in transit
Virtual private networks (VPNs)
Data at rest
Data encryption
Full disk encryption
GNU Privacy Guard (GPG)
Key management
Public key infrastructure (PKI)
Digital certificates
Certificate authorities (CA)
Lab 4.2 - GNU Privacy Guard (GPG): In this lab, you will learn how to utilize GPG and understand the operations of cryptography algorithms.
Encryption
Decryption
Signing a message
Verifying a signature
Module 21: Incident-Handling Foundations

Involves understanding the concepts of incident handling and the six-step incident-handling process. Students will also be able to identify areas of law that are important to incident handling and understand important practices in handling evidence

Incident-handling fundamentals
Six step processes for handling an incident
Legal aspects of incident handling
Lab 4.3 - Hashing: In this lab, you will learn how to utilize hashing programs and understand the operations of cryptography algorithms. Completing the lab, students will review:
Introduction to hashing tools and file integrity validation
Automating file integrity checks
Module 22: Contingency Planning - BCP/DRP

Involves understanding the critical aspect of contingency planning with a business continuity plan (BCP) and disaster recovery plan (DRP)

Contingency Planning
Business Continuity Planning (BCP)
Disaster Recovery Planning (DRP)
Module 23: Risk Management

Involves understanding the terminology and basic approaches to cyber security risk management

Risk management overview
Best-practice approach to risk management
Threat assessment, analysis, and report to management

SEC401.5 Windows Security - Module Outline

Windows Security Infrastructure
Lab - Process Hacker
Service packs, hot fixes, and backups
Windows access controls
Lab - Microsoft Baseline Security Analyzer
Enforcing security policy
Lab - Secedit
Securing Windows Network Services
Automation, auditing, and forensics
Lab - PowerShell Scripting
Module 24: The Windows Security Infrastructure

Involves the ability to identify the different types of Windows operating systems and the differences between them. Students will also be able to identify the different types of Windows operating systems and the differences between them.

Three classes of operating system:
Client
Server
Embedded
Lab 5.1 - Process Hacker: This lab teaches how to utilize a tool like Process Hacker and understand the operations of Windows and how it works.
Install and launch Process Hacker
Examine the details of a process, such as its modules and memory regions
Inject a DLL into a process and then aggressively terminate that process
Module 25: Service Packs, Hotfixes, and Backups:

Involves the understanding of how to manage Windows Service Packs and Hotfixes for a network of Windows hosts.

Service packs
E-mail security bulletins
Patch installation
Automatic updates
Windows server update services
Windows backup
System restore
Device driver rollback
Module 26: Windows Access Controls

Involves understanding how permissions are applied in the Windows NT File System, Shared Folders, Printers, Registry Keys, and Active Directory, and how Privileges are applied.

NTFS Permissions
Shared Folder Permissions
Registry Key Permissions
Active Directory Permissions
Privileges
BitLocker Drive Encryption
Lab 5.2 - Microsoft Baseline Security Analyzer: Learn to utilize a tool like Microsoft Baseline Security Analyzer and operations of Windows and how to properly secure the operating system. Completing the lab, students will understand the following topics:
Install the Microsoft Baseline Security Analyzer (MBSA)
Scan the local computer for vulnerabilities
Examine an MBSA vulnerability report
Remediate an identified vulnerability using the NET.EXE utility
Scan local system again to confirm remediation
Module 27: Enforcing Security Policy

Involves having a high-level understanding of the features of Group Policy and working with INF security templates

Applying security templates
Employing the Security Configuration and Analysis snap-in
Understanding Local Group Policy Objects
Understanding Domain Group Policy Objects
Administrative Users
AppLocker
User Account Control
Checking Recommended GPO settings, including
Password Policy
Account Lockout Policy
Security Options
Internet Explorer Security
Miscellaneous Administrative Templates
Other Settings
Lab 5.3 - Secedit: In this lab, students will learn to utilize a tool like Secedit and understand the operations of security templates and how to analyze a system
Open the PowerShell ISE desktop application
Compare current state of system against an INF security template
Apply the INF security template to the local computer to reconfigure it
Re-examine current state to confirm changes made
Module 28: Securing Windows Network Services

Involves the understanding on how to take basic measures in securing Windows network services

Best way to secure a service
Packet filtering
IPsec authentication and encryption
Internet Information Server (IIS)
Remote Desktop Services
Windows Firewall
Module 29: Automation, Auditing, and Forensics

Involves Introduction to the techniques and technologies used to audit Windows hosts.

Verifying Policy Compliance
Vulnerability Scanning and Reporting
Creating Baseline System Snapshots
Gathering Ongoing Operational Data
Employing Change Detection and Analysis
Lab 5.4 - PowerShell Scripting: In this lab, students will learn to utilize PowerShell scripting and understand the operations of scripting and automation.
Open the graphical PowerShell ISE editor (ISE = Integrated Scripting Environment)
List and manipulate processes and services
Interact with the file system, such as sorting and hashing files
Export data to HTML and comma-delimited CSV text files
Query the Windows Management Instrumentation (WMI) service
Query a local or remote Windows Event Log messages

Sec401.6 Linux Security - Module Outline

Linux Security: Structure, Permissions and Access
Hardening and Securing Linux Services
Monitoring and Attack Detection
Security Utilities
Module 30: Linux Security: Structure, Permissions and Access

Involves the foundational items that are needed to understand how to configure and secure a Linux system. It also provides an overview of the operating system and mobile markets. To lay a foundation, it provides an overview of the different operating systems that are based on Linux.

Operating System comparison
Linux security
Apple Mac OS security
Mobile security
Linux shells
Linux kernel
Permissions
User accounts
Module 31: Hardening and Securing Linux Services

Involves methods, tips, and tricks for hardening and securing Linux services. The Golden Rule to always remember is: The best way to secure a service is to turn it off.

Starting services at boot time
Package control
Kernel security
Port control and port restriction
Module 32: Monitoring and Attack Detection

Involves, Configuring and monitoring logs, logging with syslog and alternatives, parsing and filtering logs with grep, sed, awk, and cut and monitoring and accounting with uditd.

Log Aggregation and SIEM
Log Files
Log Parsing
Module 33: Security Utilities

Involves some security-enhancement utilities, capabilities, and patch-management applications.

Using built-in commands and security features
Configuring integrity checkers
Integrating host-based firewalls and managing them to provide security
Using hardening scripts
Deploying package management strategies
Understanding other tools for increasing security


# SEC504: Hacker Tools, Techniques, Exploits, and Incident Handling	GCIH	Steve Anson #

Preparation

Building an incident response kit
Identifying your core incident response team
Instrumentation of the site and system
Identification

Signs of an incident
First steps
Chain of custody
Detecting and reacting to insider threats
Containment

Documentation strategies: video and audio
Containment and quarantine
Pull the network cable, switch and site
Identifying and isolating the trust model
Eradication

Evaluating whether a backup is compromised
Total rebuild of the Operating System
Moving to a new architecture
Recovery

Who makes the determination to return to production?
Monitoring to system
Expect an increase in attacks
Special Actions for Responding to Different Types of Incidents

Espionage
Inappropriate use
Incident Record-keeping

Pre-built forms
Legal acceptability
Incident Follow-up

Lessons learned meeting
Changes in process for the future

Reconnaissance

What does your network reveal?
Are you leaking too much information?
Using forward and reverse Whois lookups, ARIN, RIPE, and APNIC
Domain Name System harvesting
Data gathering from job postings, websites, and government databases
Recon-ing
Pushpin
Identifying publicly compromised accounts
Maltego
FOCA for metadata analysis
Aggregate OSINT data collection with SpiderFoot
Scanning

Locating and attacking personal and enterprise Wi-Fi
Identifying and exploiting proprietary wireless systems
Rubber Duckie attacks to steal Wi-Fi profiles
War dialing with War-VOX for renegade modems and unsecure phones
Port scanning: Traditional, stealth, and blind scanning
Active and passive operating system fingerprinting
Determining firewall filtering rules
Vulnerability scanning using Nessus and other tools
Distributing scanning using cloud agents for blacklist evasion
Intrusion Detection System (IDS) Evasion

Foiling IDS at the network level
Foiling IDS at the application level: Exploiting the rich syntax of computer languages
Web Attack IDS evasion tactics
Bypassing IDS/IPS with TCP obfuscation techniques
Enumerating Windows Active Directory Targets

Windows Active Directory domain enumeration with BloodHound, SharpView
Windows Command and Control with PowerShell Empire
Operating system bridging from Linux to Windows targets
Defending against SMB attacks with sophisticated Windows networking features

Seemingly innocuous data leaking from your network could provide the clue needed by an attacker to blow your systems wide open. This course section covers the details associated with reconnaissance and scanning, which are the first two phases of many computer attacks.

Your networks reveal an enormous amount of information to potential attackers. In addition to looking for information leakage and open-source intelligence (OSINT), attackers also conduct detailed scans of systems, scouring for openings to get through your defenses. To break into your network, they scope out targets of opportunity, such as weak DMZ systems and turnkey platforms, unsecured modems, or vulnerable Wi-Fi and proprietary wireless systems. Attackers are increasingly employing devious scanning techniques to target publicly accessible and internal systems, seeking opportunities to manipulate otherwise benign security policies designed to protect systems. Another very hot area in computer attacks involves detailed scanning and interrogation of Windows Active Directory domains, identifying and manipulating configuration policies to their significant advantage.

If you do not have the skills needed to understand these critical phases of an attack in detail, you will not be able to protect your network. Students who take this course and master the material will understand these attacks and the associated defenses.

It is imperative that you get written permission from the proper authority in your organization before using these tools and techniques on your organization's systems. You also need to advise your network and computer operations teams of your testing schedule.

Exercises
Hands-on Exercises with the Following Tools:

Using Open Source Intelligence (OSINT) for attack reconnaissance
Wi-Fi network scanning for rogue, malicious, and misconfigured access points
Server enumeration and analysis with Nmap
Vulnerability scanning and finding prioritization
Windows networking scan and enumeration techniques

Computer attackers are ripping our networks and systems apart in novel ways, while constantly improving their techniques. This course section covers the third step of many hacker attacks: gaining access.

Attackers employ a variety of strategies to take over systems from the network level up to the application level. This section covers the attacks in depth, from the details of buffer overflow and common software flaw exploitation techniques to the latest in session hijacking of supposedly secure protocols. Additionally, you will get hands-on experience in running sniffers, exploiting common Windows networking vulnerabilities, using common tools for effective data shoveling, and bypassing host platform security endpoint tools.

Administrators need to get into the nitty-gritty of how the attacks and their associated defenses work if they want to effectively defend against these invasions. For each attack, the course explains the vulnerability, how various tools exploit it, the signature of the attack, and how to harden the system or application against the attack. Students who sign an ethics and release form are issued a USB drive containing the attack tools examined in class.

It is imperative that you get written permission from the proper authority in your organization before using these tools and techniques on your organization's system. You also need to advise your network and computer operations teams of your testing schedule.

Exercises
Hands-on Exercises with the Following Tools:

Manipulating DNS and Windows networking for credential harvesting
Using Netcat for transferring files, creating backdoors, and setting up relays
Metasploit, Metasploit, Metasploit lots of Metasploit
ARP and MAC analysis for ARP cache poisoning attack detection
CPE/CMU Credits: 6

Topics
Physical-layer Attacks

Clandestine exploitation of exposed USB ports
Simple network impersonation for credential recovery
Hijacking password libraries with cold boot recovery tools
Gathering and Parsing Packets

Active sniffing: ARP cache poisoning and DNS injection
Bettercap
Responder
LLMNR poisoning
WPAD attacks
DNS cache poisoning: Redirecting traffic on the Internet
Using and abusing Netcat, including backdoors and insidious relays
IP address spoofing variations
Encryption dodging and downgrade attacks
Operating System and Application-level Attacks

Buffer overflows in-depth
The Metasploit exploitation framework
AV and application whitelisting bypass techniques
Netcat: The Attacker's Best Friend

Transferring files, creating backdoors, and shoveling shell
Netcat relays to obscure the source of an attack
Replay attacks
Endpoint Security Bypass

How attackers use creative office document macro attacks
Detection bypass with Veil, Magic Unicorn
Putting PowerShell to work as an attack tool
AV evasion with Ghostwriting
Attack tool transfiguration with native binaries

This course section starts out by covering one of the attackers' favorite techniques for compromising systems: password attacks. We will analyze multiple attack techniques applied against password storage and selection, including password guessing and spray attacks, password cracking, and modern password mask recovery techniques. Then the course turns to another vital area often exploited by attackers: web applications. Because most organizations' homegrown web applications do not get the security scrutiny of commercial software, attackers exploit these targets using SQL injection, cross-site scripting, session cloning, and a variety of other mechanisms discussed in detail.

The course also presents a taxonomy of bots and malware attacks, including modern-day cryptomining and cryptolocker attacks. We conclude the day with a look at nasty denial-of-service attacks, illustrating how attackers can stop services or exhaust resources, as well as what you need to do to prevent their nefarious deeds.

Once intruders have gained access into a system, they want to keep that access, preventing pesky system administrators and security personnel from detecting their presence. To fool you, attackers install backdoor tools and manipulate existing software on a system to maintain access to the machine on their own terms. To defend against these attacks, you need to understand how attackers alter systems to discover the sometimes-subtle hints associated with system compromise. This course arms you with the understanding and tools you need to defend against attackers' maintaining access and covering their tracks.

It is imperative that you get written permission from the proper authority in your organization before using these tools and techniques on your organization's system. You also need to advise your network and computer operations teams of your testing schedule.

Exercises
Hands-on Exercises with the Following Tools and Topics:

Password cracking using John the Ripper
Informed password cracking mask attacks with Hashcat
Malicious browser takeover attacks using the Browser Exploitation Framework
Cross-site scripting and SQL injection web application attacks
Detecting DoS attacks
CPE/CMU Credits: 6

Topics
Password Cracking

Password cracking with John the Ripper
Hashcat mask attacks
Modern Windows Pass-the-Hash attacks
Rainbow Tables
Password guessing and spraying attacks
Web Application Attacks

Account harvesting
SQL Injection: Manipulating back-end databases
Session cloning: Grabbing other users' web sessions
Cross-site scripting
Denial-of-Service Attacks

Distributed Denial of Service: Pulsing zombies and reflected attacks
Local Denial of Service


This course section covers the fourth and fifth steps of many hacker attacks: maintaining access and covering their tracks. Computer attackers install backdoors, apply rootkits, and sometimes even manipulate the underlying kernel itself to hide their nefarious deeds. Each of these categories of tools requires specialized defenses to protect the underlying system. In this course, we will analyze the most commonly used malicious code specimens and explore future trends in malware designed to obscure ab attacker's presence and disguise attribution.

Attackers also cover their tracks by hiding files, sniffers, network usage, and active processes. Additionally, they manipulate sophisticated network protocols to evade threat hunting systems and thwart investigations. Finally, attackers often alter system logs on UNIX and Windows systems, all in an attempt to make the compromised system appear normal. This course gives you the tools and techniques you need to detect and respond to these activities on your computers and network.

It is imperative that you get written permission from the proper authority in your organization before using these tools and techniques on your organization-s system. You also need to advise your network and computer operations teams of your testing schedule.

Exercises
Hands-on Exercises with the Following Tools:

RootKits and detection
Detecting backdoors with Netstat, lsof
Manipulating Windows Event Logs for attack hiding
Hidden file detection with LADS
Analyzing memory dumps for attack identification
Covert channels using Covert_TCP
CPE/CMU Credits: 6

Topics
Maintaining Access

Backdoors: Using Poison Ivy, VNC, Ghost RAT, and other popular beasts
Trojan horse backdoors: A nasty combo
Rootkits: Substituting binary executables with nasty variations
Kernel-level Rootkits: Attacking the heart of the Operating System (Rooty, Avatar, and Alureon)
Covering the Tracks

File and directory camouflage and hiding
Log file editing on Windows and Unix
Accounting entry editing: UTMP, WTMP, shell histories, etc.
Covert channels over HTTP, ICMP, TCP, and other protocols
Sniffing backdoors and how they can really mess up your investigations unless you are aware of them
Steganography: Hiding data in images, music, binaries, or any other file type
Memory analysis of an attack
Putting It All Together

Specific scenarios showing how attackers use a variety of tools together
Analyzing scenarios based on real-world attacks
Learning from the mistakes of other organizations
Where to go for the latest attack info and trends

Over the years, the security industry has become smarter and more effective in stopping hackers. Unfortunately, hacker tools are becoming smarter and more complex. One of the most effective methods to stop the enemy is to actually test the environment with the same tools and tactics an attacker might use against you.

This workshop lets you put what you have learned over the past week into practice. You will be connected to one of the most hostile networks on earth. This network simulates the Internet and allows students to try actual attacks against live machines and learn how to protect against these attacks. The workshop will supplement the classroom training that students have already received and give them flight time with the attack tools to better understand how they work. The instructor will provide guidance on exactly what is happening as exploits and defensive measures are running. As students work on various exploits and master them, the environment will become increasingly difficult, so students will have to master additional skills in order to successfully complete the exercises.

Additionally, students can participate in the workshop's Capture-the-Flag event. By penetrating systems, discovering subtle flaws, and using puzzle-solving techniques, you can test the skills you have built over the week in this engaging contest. The Capture-the-Flag victors will win the coveted SEC504 challenge coin.

CPE/CMU Credits: 6

Topics
Hands-on Analysis

Nmap port scanner
Nessus vulnerability scanner
Network mapping
Netcat: File transfer, backdoors, and relays
Microsoft Windows network enumeration and attack
More Metasploit
Exploitation using built in OS commands
Privilege escalation
Advanced pivoting techniques

# SEC560: Network Penetration Testing and Ethical Hacking	GPEN	Jon Gorenflo #

In this course section, you'll develop the skills needed to conduct a best-of-breed, high-value penetration test. We'll go in-depth on how to build a penetration testing infrastructure that includes all the hardware, software, network infrastructure, and tools you will need to conduct great penetration tests, with specific low-cost recommendations for your arsenal. We'll then cover formulating a pen test scope and rules of engagement that will set you up for success, including a role-play exercise. We'll also dig deep into the reconnaissance portion of a penetration test, covering the latest tools and techniques, including hands-on document metadata analysis to pull sensitive information about a target environment, as well as a lab using Recon-ng to plunder a target's DNS infrastructure for information such as which anti-virus tools the target organization uses.

Exercises
Tour of the SANS Slingshot Penetration Testing Virtual Machine
Formulating an Effective Scope and Rules of Engagement
Document Metadata Treasure Hunt
Utilizing Recon-ng to Plunder DNS for Useful Information
CPE/CMU Credits: 7

Topics
The Mindset of the Professional Pen Tester
Building a World-Class Pen Test Infrastructure
Creating Effective Pen Test Scopes and Rules of Engagement
Detailed Recon Using the Latest Tools
Effective Pen Test Reporting to Maximize Impact
Mining Search Engine Results
Document Metadata Extraction and Analysis

This course section focuses on the vital task of mapping the target environment's attack surface by creating a comprehensive inventory of machines, accounts, and potential vulnerabilities. We look at some of the most useful scanning tools freely available today and run them in numerous hands-on labs to help hammer home the most effective way to use each tool. We also conduct a deep dive into some of the most useful tools available to pen testers today for formulating packets: Scapy and Netcat. We finish the module covering vital techniques for false-positive reduction, so you can focus your findings on meaningful results and avoid the sting of a false positive. And we examine the best ways to conduct your scans safely and efficiently.

Exercises
Getting the Most Out of Nmap
OS Fingerprinting and Version Scanning In-Depth
The Spectacular Scapy Packet Manipulation Suite
The Nmap Scripting Engine
The Nessus Vulnerability Scanner
Netcat for the Pen Tester
CPE/CMU Credits: 6

Topics
Tips for Awesome Scanning
Tcpdump for the Pen Tester
Nmap In-Depth: The Nmap Scripting Engine
Version Scanning with Nmap
Vulnerability Scanning with Nessus
False-Positive Reduction
Packet Manipulation with Scapy
Enumerating Users
Netcat for the Pen Tester
Monitoring Services during a Scan

In this course section we look at the many kinds of exploits that penetration testers use to compromise target machines, including client-side exploits, service-side exploits, and local privilege escalation. We'll see how these exploits are packaged in frameworks like Metasploit and its mighty Meterpreter. You'll learn in-depth how to leverage Metasploit and the Meterpreter to compromise target environments. You'll also analyze the topic of anti-virus evasion to bypass the target organization's security measures, as well as methods for pivoting through target environments, all with a focus on determining the true business risk of the target organization.

Exercises
Client-Side Attacks with Metasploit
Exploiting Network Services and Leveraging the Meterpreter
Evading Anti-Virus Tools with the Veil Framework
Metasploit Databases and Tool Integration
Port Pivoting Relays
Leveraging PowerShell Empire for Post Exploitation
CPE/CMU Credits: 6

Topics
Comprehensive Metasploit Coverage with Exploits, Stagers, and Stages
Strategies and Tactics for Anti-Virus Evasion
In-Depth Meterpreter Analysis, Hands-On
Implementing Port Forwarding Relays for Merciless Pivots
How to Leverage PowerShell Empire to Plunder a Target Environment


Once you've successfully exploited a target environment, penetration testing gets extra exciting as you perform post-exploitation, gathering information from compromised machines and pivoting to other systems in your scope. This course section zooms in on pillaging target environments and building formidable hands-on command line skills. We'll cover Windows command line skills in-depth, including PowerShell's awesome abilities for post-exploitation. We'll see how we can leverage malicious services and the incredible WMIC toolset to access and pivot through a target organization. We'll then turn our attention to password guessing attacks, discussing how to avoid account lockout, as well as numerous options for plundering password hashes from target machines including the great Mimikatz Kiwi tool. Finally, we'll look at Metasploit's fantastic features for pivoting, including the msfconsole route command.

Exercises
Windows Command Line Challenges
Creating Malicious Services and Leveraging the Wonderful WMIC Toolset
PowerShell for Post-Exploitation
Password Guessing with THC-Hydra
Metasploit Psexec and Hash Dumping
Metasploit Pivoting and Mimikatz Kiwi for Credential Harvesting
CPE/CMU Credits: 6

Topics
Windows Command Line Kung Fu for Penetration Testers
PowerShell's Amazing Post-Exploitation Capabilities
Password Attack Tips
Account Lockout and Strategies for Avoiding It
Automated Password Guessing with THC-Hydra
Retrieving and Manipulating Hashes from Windows, Linux, and Other Systems
Pivoting through Target Environments
Extracting Hashes and Passwords from Memory with Mimikatz Kiwi

In this course section, we'll go even deeper in exploiting one of the weakest aspects of most computing environments: passwords. You'll custom-compile John the Ripper to optimize its performance in cracking passwords. You'll look at the amazingly full-featured Cain tool, running it to crack sniffed Windows authentication messages. We'll use the incredible Hashcat tool for increased speed in cracking passwords, all hands-on. And we'll cover powerful "pass-the-hash" attacks, leveraging Metasploit, the Meterpreter, and more. We then turn our attention to web application pen testing, covering the most powerful and common web app attack techniques, with hands-on labs for every topic we address. We'll cover finding and exploiting cross-site scripting (XSS), cross-site request forgery (XSRF), command injection, and SQL injection flaws in applications such as online banking, blog sites, and more.

Exercises
Custom Compiling and Leveraging John the Ripper to Crack Passwords
Sniffing Windows Authentication and Cracking It with Cain
High-speed Password Cracking with Hashcat
Pass-the-Hash Attacks with Metasploit and the Meterpreter
Scanning Web Servers with Nikto
Using the ZAP Proxy to Manipulate Custom Web Applications
Exploiting Cross-Site Request Forgery Vulnerabilities
Attacking Cross-Site Scripting Flaws
Leveraging Command Injection Flaws
Exploiting SQL Injection Flaws to Gain Shell Access of Web Targets
CPE/CMU Credits: 6

Topics
Password Cracking with John the Ripper
Sniffing and Cracking Windows Authentication Exchanges Using Cain
Using Hachcat for Maximum Effectiveness
Pass-the-Hash Attacks with Metasploit and More
Finding and Exploiting Cross-Site Scripting
Utilizing Cross-Site Request Forgery Flaws
Data Plundering with SQL Injection
Leveraging SQL Injection to Perform Command Injection
Maximizing Effectiveness of Command Injection Testing

This lively session represents the culmination of the network penetration testing and ethical hacking course. You'll apply all of the skills mastered in the course in a comprehensive, hands-on workshop during which you'll conduct an actual penetration test of a sample target environment. We'll provide the scope and rules of engagement, and you'll need to achieve your goal of finding out whether the target organization's Personally Identifiable Information (PII) is at risk. As a final step in preparing you for conducting penetration tests, you'll make recommendations about remediating the risks you identify.

Exercises
A Comprehensive Lab Applying What You Have Learned Throughout the Course
Modeling a Penetration Test Against a Target Environment
CPE/CMU Credits: 6

Topics
Applying Penetration Testing and Ethical Hacking Practices End-to-End
Detailed Scanning to find Vulnerabilities and Avenues to Entry
Exploitation to Gain Control of Target Systems
Post-Exploitation to Determine Business Risk
Merciless Pivoting
Analyzing Results to Understand Business Risk and Devise Corrective Actions

The first module of SEC575 quickly looks at the significant threats affecting mobile device deployments, highlighted by a hands-on exercise evaluating network traffic from a vulnerable mobile banking application. As a critical component of a secure deployment, we will examine the architectural and implementation differences and similarities between Android (including Android Pie), Apple iOS 12, and the Apple Watch and Google Wear platforms. We will also look at the specific implementation details of popular platform features such as iBeacon, AirDrop, App Verification, and more. Hands-on exercises will be used to interact with mobile devices running in a virtualized environment, including low-level access to installed application services and application data. We'll examine the tools used to evaluate mobile devices as part of establishing a lab environment for mobile device assessments, including the analysis of mobile malware affecting Android and non-jailbroken iOS devices. Finally, we will address the threats of lost and stolen devices (and opportunities for a pen tester), including techniques to bypass mobile device lock screens.

CPE/CMU Credits: 6

Topics
Mobile Problems and Opportunities

Challenges and opportunities for secure mobile phone deployments
Weaknesses in mobile devices
Exploiting weaknesses in mobile apps: Bank account hijacking exercise
Mobile Device Platform Analysis

iOS and Android permission management models
Code signing weaknesses on Android
Inter-app communication channels on iOS
Android app execution: Android Runtime vs. Android Dalvik virtual machine
Android Nougat security benefits
Wearable Platforms

Application isolation and data sharing for Apple Watch
Network connectivity and Android Wear apps
Data exfiltration in WatchOS
Weaknesses in wearable device authentication controls
Deficiencies in Android Wear and storage encryption
Mobile Device Lab Analysis Tools

Using iOS and Android emulators
Android mobile application analysis with Android Debug Bridge (ADB) tools
Uploading, downloading, and installing applications with ADB
Application testing with the iOS Simulator
Mobile Device Malware Threats

Trends and popularity of mobile device malware
Mobile malware command and control architecture
Efficiency of Android ransomware malware threats
Analysis of iOS malware targeting non-jailbroken devices
Hands-on analysis of Android malware
Mobile malware defenses: What works and what doesn't


With an understanding of the threats, architectural components and desired security methods, we dig deeper into iOS and Android mobile platforms focusing on sandboxing and data isolation models, and on the evaluation of mobile applications. This module is designed to help build skills in analyzing mobile device data and applications through rooting and jailbreaking Android and iOS devices and using that access to evaluate file system artifacts. We will also start to evaluate the security of mobile applications, using network capture analysis tools to identify weak network protocol use and sensitive data disclosure over the network. Finally, we'll wrap up the module with an introduction to reverse engineering of iOS and Android applications using decompilers, disassemblers, and manual analysis techniques.

CPE/CMU Credits: 6

Topics
Unlocking, Rooting, and Jailbreaking Mobile Devices

Legal issues with rooting and jailbreaking
Jailbreaking iOS
Android root access through unlocked bootloaders
Root exploits for Android
Debugging and rooting Android Wear devices
Using a rooted or jailbroken device effectively: Tools you must have!
Mobile Phone Data Storage and File System Architecture

Data stored on mobile devices
Mobile device file system structure
Decoding sensitive data from database files on iOS and Android
Extracting data from Android backups
Using file system artifacts for location disclosure attacks beyond GPS coordinates
Hands-on attacks against password management apps
Network Activity Monitoring

Mobile application network capture and data extraction
Capturing iOS cellular/4G network traffic
Transparent network proxying for data capture
Encrypted data capture manipulation
Extracting files and sensitive content from network captures
Recovering sensitive data from popular cloud storage providers
Static Application Analysis

Retrieving iOS and Android apps for reverse engineering analysis
Decompiling Android applications including Android Wear
Circumventing iOS app encryption with Dumpdecrypted and Rasticrac
Header analysis and Objective-C disassembly
Accelerating iOS disassembly: Hopper and IDA Pro
Swift iOS apps and reverse engineering tools

One of the core skills you need as a mobile security analyst is the ability to evaluate the risks and threats a mobile app introduces to your organization. Through lecture and hands-on exercises in this module, with some analysis skills, you will be able to evaluate critical mobile applications to determine the type of access threats and information disclosure threats they represent. In this module we will use automated and manual application assessment tools to evaluate iOS and Android apps. We'll build upon the static application analysis skills covered in Module 2 to manipulate application components, including Android Intents and iOS URL extensions. We'll also learn and practice techniques for manipulating iOS and Android applications, such as method swizzling on iOS, and disassembly, modification, and reassembly of Android apps. The module ends with a look at a consistent system for evaluating and grading the security of mobile applications using the Application Report Card Project.

CPE/CMU Credits: 6

Topics
Automated Application Analysis Systems

iOS application vulnerability analysis with Needle
Structured iOS application header analysis
Tracing iOS application behavior and API use
Effective Android application analysis with Androwarn
Android application interaction and Intent manipulation with Drozer
Extracting secrets with KeychainDumper
Reverse Engineering Obfuscated Applications

Identifying obfuscation techniques
Decompiling obfuscated applications
Effective reconstructed code annotation with Android Studio
Decrypting obfuscated content with Simplify
Application Report Cards

Step-by-step recommendations for application analysis
Tools and techniques for mobile platform vulnerability identification and evaluation
Recommended libraries and code examples for developers
Detailed recommendations for jailbreak detection, certificate pinning, and application integrity verification
Android and iOS critical data storage: Keychain and key store recommendations
An essential component of developing a secure mobile device deployment is to perform or outsource a penetration test. Through ethical hacking and penetration testing, we examine the mobile devices and infrastructure from the perspective of an attacker, identifying and exploiting flaws that deliver unauthorized access to data or supporting networks. By identifying these flaws we can evaluate the mobile phone deployment risk to the organization with practical and useful risk metrics. Whether your role is to implement the penetration test, or to source and evaluate the penetration tests of others, understanding these techniques will help your organization identify and resolve vulnerabilities before they become incidents.

CPE/CMU Credits: 6

Topics
Manipulating Application Behavior

Runtime iOS application manipulation with Cycript
iOS method swizzling
Android application manipulation with Apktool
Reading and modifying Dalvik bytecode
Adding Android application functionality, from Java to Dalvik bytecode
Using Mobile Device Remote Access Trojans

Building RAT tools for mobile device attacks
Hiding RATs in legitimate Android apps
Customizing RATs to evade anti-virus tools
Integrating the Metasploit Framework into your mobile pen test
Effective deployment tactics for mobile device Phishing attacks
Wireless Network Probe Mapping

Monitoring network probing activity
Visualizing network discovery and search
Wireless anonymity attacks
Exploiting iOS and Android wireless network scanning characteristics
Weak Wireless Attacks

Wireless network scanning and assessment
Exploiting weak wireless infrastructure
Monitoring mobile device network scanning
Exploiting "Google WiFi" and iPad or iPhone captive portal detection
Secure network impersonation
Enterprise Wireless Security Attacks

Exploiting WPA2 Enterprise networks with certificate impersonation
Manipulating enterprise wireless authentication protocols
RADIUS server impersonation attacks

In the final module of SEC575 we will pull together all the concepts and technology covered during the week in a comprehensive Capture-the-Flag event. In this hands-on exercise, you will have the option to participate in multiple roles, including designing a secure infrastructure for the deployment of mobile phones, monitoring network activity to identify attacks against mobile devices, extracting sensitive data from a compromised iPad, and attacking a variety of mobile phones and related network infrastructure components. During this mobile security event you will put into practice the skills you have learned in order to evaluate systems and defend against attackers, simulating the realistic environment you will be prepared to protect when you get back to the office.


Continuing our look at ethical hacking and penetration testing, we turn our focus to exploiting weaknesses on iOS and Android devices. We will also examine platform-specific application weaknesses and look at the growing use of web framework attacks in mobile application exploitation. Hands-on exercises are used throughout the module to practice these attacks, exploiting both vulnerable mobile applications and the supporting back-end servers.

CPE/CMU Credits: 6

Topics
Network Manipulation Attacks

Using man-in-the-middle tools against mobile devices
Sniffing, modifying, and dropping packets as man-in-the-middle
Mobile application data injection attacks
Sidejacking Attacks

Identifying mobile applications vulnerable to sidejacking
Using sidejacking effectively in a penetration test
Hands-on exploitation of popular mobile applications
SSL/TLS Attacks

Exploiting HTTPS transactions with man-in-the-middle attacks
Core pen test technique: TLS impersonation against iOS Mail.app for password harvesting
Integrating man-in-the-middle tools with Burp Suite for effective HTTP manipulation attacks
Client-Side Injection Attacks

Android WebView and JavaScript injection for remote code execution
Harvesting session cookies through Android browser vulnerabilities with Metasploit
Using the Spec.js library for mobile browser vulnerability detection and exploit delivery
Web Framework Attacks

Site impersonation attacks
Application cross-site scripting exploits
Remote browser manipulation and control
Data leakage detection and analysis
Hands-on attacks: Mobile banking app transaction manipulation
Back-end Application Support Attacks

Exploiting SQL injection in mobile application frameworks
Leveraging client-side injection attacks
Getting end-to-end control of mobile application server resources



# SEC575: Mobile Device Security and Ethical Hacking	GMOB	Christopher Crowley #

Imagine an attack surface that is spread across your organization and in the hands of every user. It moves from place to place regularly, stores highly sensitive and critical data, and sports numerous different wireless technologies all ripe for attack. Such a surface already exists today: mobile devices. These devices are the biggest attack surface in most organizations, yet these same organizations often don't have the skills needed to assess them.


SEC575 NOW COVERS ANDROID PIE and iOS 12

SEC575: Mobile Device Security and Ethical Hacking is designed to give you the skills you need to understand the security strengths and weaknesses in Apple iOS and Android devices. Mobile devices are no longer a convenience technology: they are an essential tool carried or worn by users worldwide, often displacing conventional computers for everyday enterprise data needs. You can see this trend in corporations, hospitals, banks, schools, and retail stores throughout the world. Users rely on mobile devices more today than ever before -- we know it, and the bad guys do too. The SEC575 course examines the full gamut of these devices.

LEARN HOW TO PEN TEST THE BIGGEST ATTACK SURFACE IN YOUR ENTIRE ORGANIZATION

With the skills you learn in SEC575, you will be able to evaluate the security weaknesses of built-in and third-party applications. You'll learn how to bypass platform encryption and how to manipulate apps to circumvent client-side security techniques. You'll leverage automated and manual mobile application analysis tools to identify deficiencies in mobile app network traffic, file system storage, and inter-app communication channels. You'll safely work with mobile malware samples to understand the data exposure and access threats affecting Android and iOS, and you'll bypass lock screen to exploit lost or stolen devices.

TAKE A DEEP DIVE INTO EVALUATING MOBILE APPS, OPERATING SYSTEMS, AND THEIR ASSOCIATED INFRASTRUCTURES

Understanding and identifying vulnerabilities and threats to mobile devices is a valuable skill, but it must be paired with the ability to communicate the associated risks. Throughout the course, you'll review ways to effectively communicate threats to key stakeholders. You'll leverage tools, including Mobile App Report Cards, to characterize threats for managers and decision-makers, while also identifying sample code and libraries that developers can use to address risks for in-house applications.

YOUR MOBILE DEVICES ARE GOING TO COME UNDER ATTACK -- HELP YOUR ORGANIZATION PREPARE FOR THE ONSLAUGHT!

In employing your newly learned skills, you'll apply a step-by-step mobile device deployment penetration test. Starting with gaining access to wireless networks to implement man-in-the-middle attacks and finishing with mobile device exploits and data harvesting, you'll examine each step of the test with hands-on exercises, detailed instructions, and tips and tricks learned from hundreds of successful penetration tests. By building these skills, you'll return to work prepared to conduct your own test, or better informed on what to look for and how to review an outsourced penetration test.

Mobile device deployments introduce new threats to organizations, including advanced malware, data leakage, and the disclosure to attackers of enterprise secrets, intellectual property, and personally identifiable information assets. Further complicating matters, there simply are not enough people with the security skills needed to identify and manage secure mobile phone and tablet deployments. By completing this course, you'll be able to differentiate yourself as having prepared to evaluate the security of mobile devices, effectively assess and identify flaws in mobile applications, and conduct a mobile device penetration test -- all critical skills to protect and defend mobile device deployments.


Mobile Problems and Opportunities

Challenges and opportunities for secure mobile phone deployments
Weaknesses in mobile devices
Exploiting weaknesses in mobile apps: Bank account hijacking exercise
Mobile Device Platform Analysis

iOS and Android permission management models
Code signing weaknesses on Android
Inter-app communication channels on iOS
Android app execution: Android Runtime vs. Android Dalvik virtual machine
Android Nougat security benefits
Wearable Platforms

Application isolation and data sharing for Apple Watch
Network connectivity and Android Wear apps
Data exfiltration in WatchOS
Weaknesses in wearable device authentication controls
Deficiencies in Android Wear and storage encryption
Mobile Device Lab Analysis Tools

Using iOS and Android emulators
Android mobile application analysis with Android Debug Bridge (ADB) tools
Uploading, downloading, and installing applications with ADB
Application testing with the iOS Simulator
Mobile Device Malware Threats

Trends and popularity of mobile device malware
Mobile malware command and control architecture
Efficiency of Android ransomware malware threats
Analysis of iOS malware targeting non-jailbroken devices
Hands-on analysis of Android malware
Mobile malware defenses: What works and what doesn't

Legal issues with rooting and jailbreaking
Jailbreaking iOS
Android root access through unlocked bootloaders
Root exploits for Android
Debugging and rooting Android Wear devices
Using a rooted or jailbroken device effectively: Tools you must have!
Mobile Phone Data Storage and File System Architecture

Data stored on mobile devices
Mobile device file system structure
Decoding sensitive data from database files on iOS and Android
Extracting data from Android backups
Using file system artifacts for location disclosure attacks beyond GPS coordinates
Hands-on attacks against password management apps
Network Activity Monitoring

Mobile application network capture and data extraction
Capturing iOS cellular/4G network traffic
Transparent network proxying for data capture
Encrypted data capture manipulation
Extracting files and sensitive content from network captures
Recovering sensitive data from popular cloud storage providers
Static Application Analysis

Retrieving iOS and Android apps for reverse engineering analysis
Decompiling Android applications including Android Wear
Circumventing iOS app encryption with Dumpdecrypted and Rasticrac
Header analysis and Objective-C disassembly
Accelerating iOS disassembly: Hopper and IDA Pro
Swift iOS apps and reverse engineering tools

Automated Application Analysis Systems

iOS application vulnerability analysis with Needle
Structured iOS application header analysis
Tracing iOS application behavior and API use
Effective Android application analysis with Androwarn
Android application interaction and Intent manipulation with Drozer
Extracting secrets with KeychainDumper
Reverse Engineering Obfuscated Applications

Identifying obfuscation techniques
Decompiling obfuscated applications
Effective reconstructed code annotation with Android Studio
Decrypting obfuscated content with Simplify
Application Report Cards

Step-by-step recommendations for application analysis
Tools and techniques for mobile platform vulnerability identification and evaluation
Recommended libraries and code examples for developers
Detailed recommendations for jailbreak detection, certificate pinning, and application integrity verification
Android and iOS critical data storage: Keychain and key store recommendations


Manipulating Application Behavior

Runtime iOS application manipulation with Cycript
iOS method swizzling
Android application manipulation with Apktool
Reading and modifying Dalvik bytecode
Adding Android application functionality, from Java to Dalvik bytecode
Using Mobile Device Remote Access Trojans

Building RAT tools for mobile device attacks
Hiding RATs in legitimate Android apps
Customizing RATs to evade anti-virus tools
Integrating the Metasploit Framework into your mobile pen test
Effective deployment tactics for mobile device Phishing attacks
Wireless Network Probe Mapping

Monitoring network probing activity
Visualizing network discovery and search
Wireless anonymity attacks
Exploiting iOS and Android wireless network scanning characteristics
Weak Wireless Attacks

Wireless network scanning and assessment
Exploiting weak wireless infrastructure
Monitoring mobile device network scanning
Exploiting "Google WiFi" and iPad or iPhone captive portal detection
Secure network impersonation
Enterprise Wireless Security Attacks

Exploiting WPA2 Enterprise networks with certificate impersonation
Manipulating enterprise wireless authentication protocols
RADIUS server impersonation attacks

Network Manipulation Attacks

Using man-in-the-middle tools against mobile devices
Sniffing, modifying, and dropping packets as man-in-the-middle
Mobile application data injection attacks
Sidejacking Attacks

Identifying mobile applications vulnerable to sidejacking
Using sidejacking effectively in a penetration test
Hands-on exploitation of popular mobile applications
SSL/TLS Attacks

Exploiting HTTPS transactions with man-in-the-middle attacks
Core pen test technique: TLS impersonation against iOS Mail.app for password harvesting
Integrating man-in-the-middle tools with Burp Suite for effective HTTP manipulation attacks
Client-Side Injection Attacks

Android WebView and JavaScript injection for remote code execution
Harvesting session cookies through Android browser vulnerabilities with Metasploit
Using the Spec.js library for mobile browser vulnerability detection and exploit delivery
Web Framework Attacks

Site impersonation attacks
Application cross-site scripting exploits
Remote browser manipulation and control
Data leakage detection and analysis
Hands-on attacks: Mobile banking app transaction manipulation
Back-end Application Support Attacks

Exploiting SQL injection in mobile application frameworks
Leveraging client-side injection attacks
Getting end-to-end control of mobile application server resources




# SEC599: Defeating Advanced Adversaries - Purple Team Tactics & Kill Chain Defenses	GDAT	Bryce Galbraith #

You just got hired to help our virtual organization "SYNCTECHLABS" build out a cyber security capability. On your first day, your manager tells you: "We looked at some recent cyber security trend reports and we feel like we've lost the plot. Advanced persistent threats, ransomware, denial of service... We're not even sure where to start!"

Cyber threats are on the rise: ransomware tactics are affecting small, medium, and large enterprises alike, while state-sponsored adversaries are attempting to obtain access to your most precious crown jewels. SEC599: Defeating Advanced Adversaries - Purple Team Tactics & Kill Chain Defenses will arm you with the knowledge and expertise you need to overcome today's threats. Recognizing that a prevent-only strategy is not sufficient, we will introduce security controls aimed at stopping, detecting, and responding to your adversaries.

Course authors Stephen Sims and Erik Van Buggenhout (both certified as GIAC Security Experts) are hands-on practitioners who have built a deep understanding of how cyber attacks work through penetration testing and incident response. While teaching penetration testing courses, they were often asked the question: "How do I prevent or detect this type of attack?" Well, this is it! SEC599 gives students real-world examples of how to prevent attacks. The course features more than 20 labs plus a full-day Defend-the-Flag exercise during which students attempt to defend our virtual organization from different waves of attacks against its environment.

Our six-part journey will start off with an analysis of recent attacks through in-depth case studies. We will explain what types of attacks are occurring and introduce formal descriptions of adversary behavior such as the Cyber Kill Chain and the MITRE ATT&CK framework. In order to understand how attacks work, you will also compromise our virtual organization "SYNCTECHLABS" in section one exercises.

In sections two, three, four and five we will discuss how effective security controls can be implemented to prevent, detect, and respond to cyber attacks. The topics to be addressed include:

Leveraging MITRE ATT&CK as a "common language" in the organization
Building your own Cuckoo sandbox solution to analyze payloads
Developing effective group policies to improve script execution (including PowerShell, Windows Script Host, VBA, HTA, etc.)
Highlighting key bypass strategies for script controls (Unmanaged Powershell, AMSI bypasses, etc.)
Stopping 0-day exploits using ExploitGuard and application whitelisting
Highlighting key bypass strategies in application whitelisting (focus on AppLocker)
Detecting and preventing malware persistence
Leveraging the Elastic stack as a central log analysis solution
Detecting and preventing lateral movement through Sysmon, Windows event monitoring, and group policies
Blocking and detecting command and control through network traffic analysis
Leveraging threat intelligence to improve your security posture
SEC599 will finish with a bang. During the Defend-the-Flag challenge in the final course section, you will be pitted against advanced adversaries in an attempt to keep your network secure. Can you protect the environment against the different waves of attacks? The adversaries aren't slowing down, so what are you waiting for?

Our six-part journey starts with an analysis of recent attacks through in-depth case studies. We will explain what's happening in real situations and introduce the Cyber Kill Chain and MITRE ATT&CK framework as a structured approach to describing adversary tactics and techniques. We will also explain what purple teaming is, typical tools associated with it, and how it can be best organized in your organization. In order to understand how attacks work, students will also compromise our virtual organization "SYNCTECHLABS" during section one exercises.

Exercises
One click is all it takes...
Hardening our domain using SCT and STIG
Kibana, ATT&CK Navigator, and FlightSim
Automated reconnaissance using SpiderFoot
CPE/CMU Credits: 6

Topics
Course Outline and Lab Setup
Course objectives and lab environment
What's happening out there?
Introducing SYNCTECHLABS
Exercise: One click is all it takes...
Adversary Emulation and the Purple Team
Introducing the extended Kill Chain
What is the purple team?
MITRE ATT&CK framework and "purple tools"
Key controls for prevention and detection
Exercise: Hardening our domain using SCT and STIG
Building a detection stack
Exercise: Kibana, ATT&CK Navigator, and FlightSim
Reconnaissance
Reconnaissance - Getting to know the target
Exercise: Automated reconnaissance using SpiderFoot


Section 2 will cover how the attacker attempts to deliver and execute payloads in the organization. We will first cover adversary techniques (e.g., creation of malicious executables and scripts), then focus on how both payload delivery (e.g., phishing mails) and execution (e.g., double-clicking of the attachment) can be hindered. We will also introduce YARA as a common payload description language and SIGMA as a vendor-agnostic use-case description language.

Exercises
Stopping NTLMv2 sniffing and relay attacks in Windows
Building a Sandbox using Cuckoo and YARA
Configuring AppLocker
Controlling script execution in the enterprise
Detection with Script Block Logging, Sysmon, and SIGMA
Preventing payload execution using ProcFilter
CPE/CMU Credits: 6

Topics
Common Delivery Mechanisms
Hindering Payload Delivery
Removable media and network (NAC, MDM, etc.) controls
Exercise: Stopping NTLMv2 sniffing and relay attacks in Windows
Mail controls, web proxies, and malware sandboxing
YARA - A common payload description language
Exercise: Building a Sandbox using Cuckoo and YARA
Preventing Payload Execution
Initial execution - Application whitelisting
Exercise: Configuring AppLocker
Initial execution - Visual Basic, JS, HTA, and PowerShell
Exercise: Controlling script execution in the enterprise
Initial execution - How to detect?
Exercise: Detection with Script Block Logging, Sysmon, and SIGMA
Operationalizing YARA rules - Introducing ProcFilter
Exercise: Preventing payload execution using ProcFilter

Section 3 will first explain how exploitation can be prevented or detected. We will show how security should be an integral part of the software development lifecycle and how this can help prevent the creation of vulnerable software. We will also explain how patch management fits in the overall picture.

Next, we will zoom in on exploit mitigation techniques, both at compile-time (e.g., ControlFlowGuard) and at run-time (ExploitGuard). We will provide an in-depth explanation of what the different exploit mitigation techniques (attempt to) cover and how effective they are. We'll then turn to a discussion of typical persistence strategies and how they can be detected using Autoruns and OSQuery. Finally, we will illustrate how command and control channels are being set up and what controls are available to the defender for detection and prevention.

Exercises
Exploit mitigation using Compile-Time Controls
Exploit mitigation using ExploitGuard
Catching persistence using Autoruns and OSQuery
Detecting command and control channels using Suricata, JA3 and RITA
CPE/CMU Credits: 6

Topics
Protecting Applications from Exploitation
Software development lifecycle (SDL) and threat modeling
Patch management
Exploit mitigation techniques
Exercise: Exploit mitigation using Compile-Time Controls
Exploit mitigation techniques - ExploitGuard, EMET, and others
Exercise: Exploit mitigation using ExploitGuard
Avoiding Installation
Typical persistence strategies
How do adversaries achieve persistence?
Exercise: Catching persistence using Autoruns and OSQuery
Foiling Command and Control
Detecting command and control channels
Exercise: Detecting command and control channels using Suricata, JA3, and RITA

Section 4 will focus on how adversaries move laterally throughout an environment. A key focus will be on Active Directory (AD) structures and protocols (local credential stealing, NTLMv2, Kerberosm, etc.). We will discuss common attack strategies, including Windows privilege escalation, UAC bypasses, (Over-) Pass-the-Hash, Kerberoasting, Silver Tickets, and others. We'll also cover how BloodHound can be used to develop attack paths through the AD environment. Finally, we will discuss how lateral movement can be identified in the environment and how cyber deception can be used to catch intruders red-handed!

Exercises
Implementing LAPS
Local Windows privilege escalation techniques
Hardening Windows against credential compromise
Mapping attack paths using BloodHound
Kerberos attack strategies
Detecting lateral movement in AD
CPE/CMU Credits: 6

Topics
Protecting Administrative Access
Active Directory security concepts
Principle of least privilege and UAC
Exercise: Implementing LAPS
Privilege escalation techniques in Windows
Exercise: Local Windows privilege escalation techniques
Key Attack Strategies against AD
Abusing local admin privileges to steal more credentials
Exercise: Hardening Windows against credential compromise
Bloodhound - Mapping out AD attack paths
Exercise: Mapping attack paths using BloodHound
Kerberos attacks: Kerberoasting, Silver tickets, Over-PtH
Exercise: Kerberos attack strategies
How Can We Detect Lateral Movement?
Key logs to detect lateral movement in AD
Deception - Tricking the adversary
Exercise: Detecting lateral movement in AD


Section five focuses on stopping the adversary during the final stages of the attack:

How does the adversary obtain "domain dominance" status? This includes the use of Golden Tickets, Skeleton Keys, and directory replication attacks such as DCSync and DCShadow.
How can data exfiltration be detected and stopped?
How can threat intelligence aid defenders in the Cyber Kill Chain?
How can defenders perform effective incident response?
As always, theoretical concepts will be illustrated during the different exercises performed throughout the day.

Exercises
Domain dominance
Detecting data exfiltration
Leveraging threat intelligence with MISP and Loki
Hunting your environment using OSQuery
Finding malware using Volatility and YarGen
CPE/CMU Credits: 6

Topics
Domain Dominance
Dominating the AD - Basic strategies
Golden Ticket, Skeleton Key, DCSync, and DCShadow
Detecting domain dominance
Exercise: Domain dominance
Data Exfiltration
Common exfiltration strategies
Exercise: Detecting data exfiltration
Leveraging Threat Intelligence
Defining threat intelligence
Exercise: Leveraging threat intelligence with MISP and Loki
Threat Hunting and Incident Response
Proactive threat hunting strategies
Exercise: Hunting your environment using OSQuery
Incident response process
Exercise: Finding malware using Volatility and YarGen

The course culminates in a team-based Defend-the-Flag competition. Section six is a full chapter of hands-on work applying the principles taught throughout the course. Your team will progress through multiple levels and missions designed to ensure mastery of the modern cyber security controls promoted all week long. This challenging exercise will reinforce key principles in a fun, hands-on, team-based challenge.

Note that OnDemand students will enjoy this exercise on an individual basis. As always, SANS SME's are available to support every OnDemand student's experience.

CPE/CMU Credits: 6

Topics
Applying Previously Covered Security Controls In-depth
Reconnaissance
Weaponization
Delivery
Exploitation
Installation
Command and Control
Action on Objectives




# SEC617: Wireless Penetration Testing and Ethical Hacking	GAWN	Larry Pesce #

This course is designed for professionals seeking a comprehensive technical ability to understand, analyze, and defend the various wireless technologies that have become ubiquitous in our environments and, increasingly, key entrance points for attackers.

The authors of SEC617, as penetration testers themselves, know that many organizations overlook wireless security as an attack surface, and therefore fail to establish required defenses and monitoring, even though wireless technologies are now commonplace in executive suites, financial departments, government offices, manufacturing production lines, retail networks, medical devices, and air traffic control systems. Given the known risks of insecure wireless technologies and the attacks used against them, SEC617 was designed to help people build the vital skills needed to identify, evaluate, assess, and defend against these threats. These skills are 'must-have' for any high-performing security organization.

NOW COVERING WI-FI, ZIGBEE, Z-WAVE, DECT, RFID, AND SOFTWARE -DEFINED RADIO

For many analysts, "wireless" was once synonymous with "Wi-Fi," the ever-present networking technology, and many organizations deployed complex security systems to protect these networks. Today, wireless takes on a much broader meaning -- not only encompassing the security of Wi-Fi systems, but also the security of Bluetooth, Zigbee, Z-Wave, DECT, RFID, NFC, contactless smart cards, and even proprietary wireless systems. To effectively evaluate the security of wireless systems, your skillset needs to expand to include many different types of wireless technologies.

EXPLORE WI-FI ATTACKS AGAINST WINDOWS, MacOS, iOS, AND ANDROID

SEC617 will give you the skills you need to understand the security strengths and weaknesses of wireless systems. You will learn how to evaluate the ever-present cacophony of Wi-Fi networks and identify the Wi-Fi access points (APs) and client devices that threaten your organization. You will learn how to assess, attack, and exploit deficiencies in modern Wi-Fi deployments using WPA2 technology, including sophisticated WPA2 Enterprise networks. You will gain a strong, practical understanding of the many weaknesses in Wi-Fi protocols and how to apply that understanding to modern wireless systems. Along with identifying and attacking Wi-Fi access points, you will learn to identify and exploit the behavioral differences in how client devices scan for, identify, and select APs, with deep insight into the behavior of the Windows 10, macOS, Apple iOS, and Android Wi-Fi stacks.

EXAMINE BLE TECHNOLOGY WITH NEW INSIGHT, CERTIFYING DEVICES FOR USE

A significant portion of the course focuses on Bluetooth and Bluetooth Low Energy (BLE) attacks, targeting a variety of devices, including wireless keyboards, smart light bulbs, mobile devices, audio streaming devices, and more. You will learn to assess a target Bluetooth device, identify the present (or absent) security controls, and apply a solid checklist to certify a device's security for use within your organization.

LEARN TO ATTACK POPULAR WIRELESS TECHNOLOGY BEYOND WI-FI TARGETS

Beyond analyzing Wi-Fi and Bluetooth security threats, analysts must also understand many other wireless technologies that are widely utilized in complex systems. SEC617 provides insight and hands-on training to help analysts identify and assess the use of Zigbee and Z-Wave wireless systems used for automation, control, and smart home systems. The course also investigates the security of cordless telephony systems in the worldwide Digital Enhanced Cordless Telephony (DECT) standard, including audio eavesdropping and recording attacks.

ATTACK AND MANIPULATE RFID AND NFC SYSTEMS

Radio frequency identification (RFID), near field communication (NFC), and contactless smart card systems are more popular than ever in countless applications such as point of sale systems and data center access control systems. You will learn how to assess and evaluate these deployments using hands-on exercises to exploit the same kinds of flaws discovered in mass transit smart card systems, hotel guest room access systems, and more.

GAIN NEW INSIGHT INTO WIRELESS PROTOCOLS WITH SOFTWARE-DEFINED RADIO

In addition to standards-based wireless systems, we also dig deeper into the radio spectrum using software-defined radio (SDR) systems to scour for signals. Using SDR, you will gain new insight into how widely pervasive wireless systems are deployed. With your skills in identifying, decoding, and evaluating the data these systems transmit, you will be able to spot vulnerabilities even in custom wireless infrastructures.

JUMPSTART YOUR TOOLKIT WITH SOFTWARE AND HARDWARE ASSESSMENT TOOLS SUPPLIED IN CLASS

SEC617 is a technical, hands-on penetration testing skill-development course that requires a wide variety of super-useful hardware and software tools to successfully build new skills. In this course, you will receive the SANS Wireless Assessment Toolkit (SWAT), which is a collection of hardware and software tools that will jumpstart your ability to assess wireless systems. The toolkit includes a high-powered 802.11b/g/n Wi-Fi card, a long-range Bluetooth Classic/Low Energy adapter, a high-frequency RFID reader and writer, and a software-defined radio receiver. You will also receive a customized Linux software environment so you can work on assessing systems and avoid fighting hardware/software incompatibility.


The first section of the course quickly looks at wireless threats and attack surfaces and analyzes where you will likely see non-Wi-Fi systems deployed in modern networks. We start off with a look at fundamental analysis techniques for evaluating Wi-Fi networks, including the identification and analysis of rogue devices, and finish with a dive into remote penetration testing techniques using compromised Windows 10 and macOS devices to pivot.

CPE/CMU Credits: 6

Topics
Characterize the Wireless Threat

Recognizing protocol weaknesses and cryptographic failures across wireless technologies
Why popular smart phones increase our exposure to attack
Anatomy of a wireless attack: How real-world attackers exploit wireless systems
Introduction to the SWAT kit
Sniffing Wi-Fi

Leveraging built-in functionality in every Wi-Fi card for penetration testing
Wireless packet capture on Linux, Windows, and macOS
Overcoming physical-layer challenges in IEEE 802.11n, IEEE 802.11ac packet sniffers
Detecting cheaters: Radio regulatory domain bypass hacks
Packet capture, filter, and analysis with tcpdump, Wireshark, and Kismet
Tools and techniques for understanding your radio frequency exposure with topographic range maps
Rogue Access Point (AP) Analysis

Characterizing the threat and attacker motives for rogue APs
Wired-side analysis for rogue APs using open-source tools
Filtering out Wi-Fi noise to focus on and characterize rogue device threats
Correlating Wi-Fi devices with your network infrastructure
Effective unauthorized transmitter location analysis techniques

After developing skills needed to capture and evaluate Wi-Fi activity, we start our look at exploiting Wi-Fi, targeting AP and client devices. We cover techniques that apply to any Wi-Fi products, from consumer to enterprise-class devices, focusing on understanding protocol-level deficiencies that will continue to be applied throughout the course on non-Wi-Fi wireless systems as well.

CPE/CMU Credits: 6

Topics
Exploiting Wi-Fi Hotspots

Bypassing authentication on hotspot networks
Exploiting mobile application data disclosure on open networks
Luring Wi-Fi client victims with Wi-Fi hotspot impersonation
Leveraging sidejacking attacks against hotspot networks
Wi-Fi Client Attacks

Leveraging Wi-Fi timing attacks for traffic manipulation
Bypassing client isolation security on Wi-Fi networks
Wi-Fi client privacy and isolation attacks through preferred network list disclosure
Leveraging commercial tools such as the Wi-Fi Pineapple for AP impersonation
Integrating Metasploit Meterpreter payloads in Wi-Fi network injection attacks
Exploiting WEP

A brief look at WEP technology and exploitation
Applying the cryptography in WEP to non-Wi-Fi protocols
Denial of Service (DoS) Attacks

Identifying types of DoS attacks and attack targets
Leveraging RF jammers in a pen test
Selective client DoS targeting to manipulate network roaming events
Single-client to entire-network Wi-Fi DoS techniques
Wi-Fi Fuzzing for Bug Discovery

Introduction to fuzzing techniques
Identifying complex parsing issues in Wi-Fi protocols
Using Scapy to build malformed packets
Identifying bugs in APs and client devices through fuzzing
Applying fuzzing as part of an overall Wi-Fi security analysis

We finish our look at Wi-Fi attack techniques with a detailed look at assessing and exploiting WPA2 networks. Starting with WPA2 consumer networks, we investigate the flaws associated with pre-shared key networks and Wi-Fi Protected Setup (WPS) deployments, continuing with a look at exploiting WPA2 Enterprise networks using various Extensible Authentication Protocol (EAP) methods.

We continue to investigate the security of wireless networks on day 3, switching to non-Wi-Fi analysis with a look at exploiting the worldwide Digital Enhanced Cordless Telephony (DECT) standard to capture and export audio conversations from cordless headsets and phones. We also investigate the security of Zigbee and IEEE 802.15.4 networks, looking at cryptographic flaws, key management failures, and an introduction to hardware attacks.

CPE/CMU Credits: 6

Topics
Attacking WPA2 Pre-Shared Key Networks

In-depth analysis of key derivation functions in WPA2
Capturing and evaluating WPA2-PSK client network authentication exchanges
Attacking the passphrase selection of WPA2-PSK
Attacking WPA2 Enterprise Networks

Differentiating PSK-based WPA2 and WPA2 Enterprise networks
Leveraging identity disclosure in WPA2 Enterprise networks
Exploiting Windows 10 Native Wi-Fi and PEAP networks
Exploiting iOS and Android Enterprise Wi-Fi network roaming behavior
Using Hostapd-WPE for Enterprise network impersonation
Password recovery through MS-CHAPv2 cracking
Attacking Digital Enhanced Cordless Telephony Deployments

DECT as a cordless telephony and data application technology
DECT physical and MAC layer fundamentals
Evaluating the DECT authentication and encryption mechanisms
Eavesdropping and recording audio conversations on DECT cordless phones
Attacking Zigbee Deployments

In-depth analysis of Zigbee and IEEE 802.15.4 physical and MAC layer architecture
Zigbee and IEEE 802.15.4 authentication and cryptographic controls
Weaknesses in Zigbee key provisioning and management mechanisms
Tools for eavesdropping on and manipulating Zigbee networks
Exploiting Zigbee Over-the-Air key provisioning
Locating Zigbee devices with signal analysis tools


Bluetooth technology is nearly as pervasive as Wi-Fi, with widespread adoption in smart phones, fitness trackers, wireless keyboard, smart watches, and more. In this module, we dig into the Bluetooth Classic, Enhanced Data Rate, and Low Energy protocols, including tools and techniques to evaluate target devices for vulnerabilities.

Immediately following our look at Bluetooth technology, we jump into the practical application of Software Defined Radio (SDR) technology to identify, decode, and assess proprietary wireless systems. We investigate the hardware and software available for SDR systems, and look at the tools and techniques to start exploring this exciting area of wireless security assessment.

CPE/CMU Credits: 6

Topics
Bluetooth Introduction and Attack Techniques

Understanding the physical layer evolution of Bluetooth and packet capture techniques
Bluetooth pairing techniques and vulnerabilities
Attacking Bluetooth pairing for PIN and key recovery
Techniques for identifying non-discoverable Bluetooth devices
Bluetooth Low Energy Introduction and Attack Techniques

Recognizing BLE Frequency-Hopping RF patterns
Security analysis of BLE pairing options -- just works, OOP, passkey, and numeric comparison
Analysis of expensive and inexpensive BLE packet capture tools for Windows, Linux, and Android devices
Scanning BLE device services with bluetoothctl, Android apps, and related tools
Practical exploitation of BLE services
Practical Application of Software-Defined Radio (SDR)

Guide to using SDR in a penetration test
RF spectrum visualization and signal hunting with SDR# and GQRX
Decoding ADS-B aircraft beacon traffic
Eavesdropping on POCSAG and FLEX pager messaging
GSM cell tower scanning and evaluation with SDR
Leveraging capture and replay attacks to exploit vehicle keyless entry systems


On day 5, we evaluate RFID technology in its multiple forms to identify the risks associated with privacy loss and tracking, while also building an understanding of both low-frequency and high-frequency RFID systems and NFC. We examine the security associated with contactless Point of Sale (PoS) terminals, including Apple Pay and Google Wallet, and proximity lock access systems from HID and other vendors. We also examine generalized techniques for attacking smart card systems, including critical data analysis skills needed to bypass the intended security of smart card systems used for mass transit systems, concert venues, bike rentals, and more.

CPE/CMU Credits: 6

Topics
RFID Overview

Understanding the components, transmission frequencies, and protocols in RFID systems
Differentiating active and passive RFID systems
Understanding NFC systems components and protocols
Practical range extensions in RFID attacks
RFID Tracking and Privacy Attacks

Practical location disclosure attacks in RFID systems
Case study: E-Z Pass location disclosure threats
Manipulating Apple iBeacon location tracking systems
RFID tracking through Ultra-High Frequency (UHF) tags
Low-Frequency RFID Attacks

Case study: cloning RFID tags used for bike rental systems
Leveraging RFIDiot for low-frequency RFID attacks
Attacking HID ProxCard proximity lock systems
Leveraging the ProxMark RDV2 for low-frequency RFID attacks
Brute-forcing HID identifiers for unauthorized access
Extending range in HID cloning attacks
Manual low-frequency tag analysis and bitstream decoding
Exploiting Contactless RFID Smart Cards

Conducting smart card reconnaissance analysis with Linux and Android
Attacking Europay-Mastercard-Visa (EMV) PoS systems
Exploiting MIFARE Classic smart card systems
Effective smart card cloning with UID impersonation
Attacking MIFARE Ultralight, Ultralight-C, and DESFire smart card systems
Emulating smart cards with the ProxMark RDV2
Attacking NFC

Decoding the NFC Data Exchange Format (NDEF) protocol
Reading and writing NFC/NDEF tags
Analysis of Android Beam, Google Wallet, and Apple Pay NFC systems
Exploiting NFC smart toys
Attacking Android devices with malicious NFC tags



# SEC660: Advanced Penetration Testing, Exploit Writing, and Ethical Hacking	GXPN	Brandon McCrillis #

SEC660: Advanced Penetration Testing, Exploit Writing, and Ethical Hacking is designed as a logical progression point for those who have completed SANS SEC560: Network Penetration Testing and Ethical Hacking, or for those with existing penetration testing experience. Students with the prerequisite knowledge to take this course will walk through dozens of real-world attacks used by the most seasoned penetration testers. The methodology of a given attack is discussed, followed by exercises in a hands-on lab to consolidate advanced concepts and facilitate the immediate application of techniques in the workplace. Each day of the course includes a two-hour evening boot camp to drive home additional mastery of the techniques discussed. A sample of topics covered includes weaponizing Python for penetration testers, attacks against network access control (NAC) and virtual local area network (VLAN) manipulation, network device exploitation, breaking out of Linux and Windows restricted environments, IPv6, Linux privilege escalation and exploit-writing, testing cryptographic implementations, fuzzing, defeating modern OS controls such as address space layout randomization (ASLR) and data execution prevention (DEP), return-oriented programming (ROP), Windows exploit-writing, and much more!

Attackers are becoming more clever and their attacks more complex. To keep up with the latest attack methods, you need a strong desire to learn, the support of others, and the opportunity to practice and build experience. This course provides attendees with in-depth knowledge of the most prominent and powerful attack vectors and furnishes an environment to perform these attacks in numerous hands-on scenarios. The course goes far beyond simple scanning for low-hanging fruit and shows penetration testers how to model the abilities of an advanced attacker to find significant flaws in a target environment and demonstrate the business risk associated with these flaws.

SEC660 starts off by introducing advanced penetration concepts and providing an overview to prepare students for what lies ahead. The focus of day one is on network attacks, an area often left untouched by testers. Topics include accessing, manipulating, and exploiting the network. Attacks are performed against NAC, VLANs, OSPF, 802.1X, CDP, IPv6, VOIP, SSL, ARP, SNMP, and others. Day two starts with a technical module on performing penetration testing against various cryptographic implementations, then turns to network booting attacks, escaping Linux restricted environments such as chroot, and escaping Windows restricted desktop environments. Day three jumps into an introduction of Python for penetration testing, Scapy for packet crafting, product security testing, network and application fuzzing, and code coverage techniques. Days four and five are spent exploiting programs on the Linux and Windows operating systems. You will learn to identify privileged programs, redirect the execution of code, reverse-engineer programs to locate vulnerable code, obtain code execution for administrative shell access, and defeat modern operating system controls such as ASLR, canaries, and DEP using ROP and other techniques. Local and remote exploits as well as client-side exploitation techniques are covered. The final course day is devoted to numerous penetration testing challenges that require students to solve complex problems and capture flags.

Among the biggest benefits of SEC660 is the expert-level hands-on guidance provided through the labs and the additional time allotted each evening to reinforce daytime material and master the exercises.

You Will Learn:

How to perform penetration testing safely against network devices such as routers, switches, and NAC implementations.
How to test cryptographic implementations.
How to leverage an unprivileged foothold for post exploitation and escalation.
How to fuzz network and stand-alone applications.
How to write exploits against applications running on Linux and Windows systems.
How to bypass exploit mitigations such as ASLR, DEP, and stack canaries.

Day one serves as an advanced network attack module, building on knowledge gained from SEC560: Network Penetration Testing and Ethical Hacking. The focus will be on obtaining access to the network; manipulating the network to gain an attack position for eavesdropping and attacks, and for exploiting network devices; leveraging weaknesses in network infrastructure; and taking advantage of client frailty.

CPE/CMU Credits: 8

Topics
Bypassing network access/admission control (NAC)
Impersonating devices with admission control policy exceptions
Exploiting EAP-MD5 authentication
Custom network protocol manipulation with Ettercap and custom filters
Multiple techniques for gaining man-in-the-middle network access
IPv6 for penetration testers
Exploiting OSPF authentication to inject malicious routing updates
Using Evilgrade to attack software updates
Overcoming SSL transport encryption security with Sslstrip
Remote Cisco router configuration file retrieval

Day two starts by taking a tactical look at techniques that penetration testers can use to investigate and exploit common cryptography mistakes. We begin by building some fundamental knowledge on how ciphers operate, without getting bogged down in complex mathematics. Then we move on to techniques for identifying, assessing, and attacking real-world crypto implementations. We finish the module with lab exercises that allow students to practice their newfound crypto attack skill set against reproduced real-world application vulnerabilities.

The day continues with advanced techniques but focuses more on post exploitation tasks. We leverage an initial foothold to further exploit the rest of the network. We abuse allowed features to escape restricted environments. First we will build up knowledge of local restrictions on hosts. Once we establish a set of possible restrictions, we leverage that knowledge to circumvent them. We will cover the core components that restrict the desktop and a variety of escape possibilities. The Windows escape exercise is a perfect, real-world demonstration of the risks of relying on obfuscation and blacklisting to thwart attacks.

As a major part of post exploitation, we cover PowerShell: including basic concepts and tasks, enterprise tasks, and outright offensive tasks. We will discuss and use a variety of PowerShell attack tools to discover vulnerabilities and gain privileges. The day ends with a challenging boot camp exercise against a full network environment comprised of a variety of modern, representative, and fully patched systems with no obvious external vulnerabilities.

CPE/CMU Credits: 8

Topics
Pen testing cryptographic implementations
Exploiting CBC bit flipping vulnerabilities
Exploiting hash length extension vulnerabilities
Delivering malicious operating systems to devices using network booting and PXE
PowerShell Essentials
Enterprise PowerShell
Post Exploitation with PowerShell and Metasploit
Escaping Software Restrictions
Two-hour evening Capture the Flag exercise against a modern network with hardened servers, desktops, and vApp targets

Day three brings together the multiple skill sets needed for creative analysis in penetration testing. We start by discussing product security testing. The day continues with a focus on how to leverage Python as a penetration tester - the aim is to help students unfamiliar with Python start modifying scripts to add their own functionality, while also helping seasoned Python scripters improve their skills. Once we leverage the Python skills in creative lab exercises, we move on to leveraging Scapy for custom network targeting and protocol manipulation. Using Scapy, we examine techniques for transmitting and receiving network traffic beyond what canned tools can accomplish, including IPv6. Next, we take a look at network protocol and file format fuzzing. We leverage fuzzing to target both common network protocols and popular file formats for bug discovery. We use hands-on exercises to develop custom protocol fuzzing grammars to discover bugs in popular software. Finally, we carefully discuss the concept of code coverage and how it goes hand-in-hand with fuzzing. We will conduct a lab using the Paimei Reverse Engineering Framework and IDA Pro to demonstrate the techniques discussed.

CPE/CMU Credits: 8

Topics
Becoming familiar with Python types
Leveraging Python modules for real-world pen tester tasks
Manipulating stateful protocols with Scapy
Using Scapy to create a custom wireless data leakage tool
Product security testing
Using Taof for quick protocol mutation fuzzing
Optimizing your fuzzing time with smart target selection
Automating target monitoring while fuzzing with Sulley
Leveraging Microsoft Word macros for fuzzing .docx files
Block-based code coverage techniques using Paimei



Day four begins by walking through memory from an exploitation perspective as well as introducing x86 assembler and linking and loading. These topics are important for anyone performing penetration testing at an advanced level. Processor registers are directly manipulated by testers and must be intimately understood. Disassembly is a critical piece of testing and will be used throughout the remainder of the course. We will take a look at the Linux OS from an exploitation perspective and discuss privilege escalation. We continue by describing how to look for SUID programs and other likely points of vulnerabilities and misconfigurations. The material will focus on techniques that are critical to performing penetration testing on Linux applications.

We then go heavily into stack overflows on Linux to gain privilege escalation and code execution. We will first cover using a debugger to expose weak passwords. Then we will go over redirection of program execution and, finally, code execution. Techniques such as return to buffer and return to C library (ret2libc) will be covered, as well as an introduction to return-oriented programming. The remainder of the day takes students through techniques used to defeat or bypass OS protections such as stack canaries and address space layout randomization (ASLR). The goal of this section is to expose students to common obstacles on modern Linux-based systems.

CPE/CMU Credits: 8

Topics
Stack and dynamic memory management and allocation on the Linux OS
Disassembling a binary and analyzing x86 assembly code
Performing symbol resolution on the Linux OS
Identifying vulnerable programs
Code execution redirection and memory leaks
Identifying and analyzing stack-based overflows on the Linux OS
Performing return-to-libc (ret2libc) attacks on the stack
Return-oriented programming
Defeating stack protection on the Linux OS
Defeating ASLR on the Linux OS

Day five starts off covering the OS security features (ASLR, DEP, etc.) added to the Windows OS over the years as well as Windows-specific constructs, such as the process environment block (PEB), structured exception handling (SEH), thread information block (TIB), and the Windows application programming interfaces (API). Differences between Linux and Windows will be covered. These topics are critical in assessing Windows-based applications. We then focus on stack-based attacks against programs running on the Windows OS. After finding a vulnerability in an application, the student will work with Immunity Debugger to turn the bug into an opportunity for code execution and privilege escalation. Advanced stack-based techniques such as disabling data execution prevention (DEP) are covered. Client-side exploitation will be introduced, as it is a highly common area of attack. We continue with the topic of return-oriented programming (ROP), demonstrating the technique against a vulnerable application, while looking at defeating hardware DEP and address space layout randomization (ASLR) on Windows 7, Windows 8, and Windows 10. We then have a module on porting over an exploit into the Metasploit Framework and on how to quickly identify bad characters in your shellcode and as input into a program. Finally, we will take a quick look at shellcode and the differences between shellcode on Linux and Windows, followed by a ROP challenge.

CPE/CMU Credits: 8

Topics
The state of Windows OS protections on Windows 7, 8, 10, Server 2008 and 2012
Understanding common Windows constructs
Stack exploitation on Windows
Defeating OS protections added to Windows
Creating a Metasploit module
Advanced stack-smashing on Windows
Using ROP
Building ROP chains to defeat DEP and bypass ASLR
Windows 7 and Windows 8 exploitation
Porting Metasploit modules
Client-side exploitation
Windows Shellcode

This day will serve as a real-world challenge for students by requiring them to utilize skills they have learned throughout the course, think outside the box, and solve a range of problems from simple to complex. A web server scoring system and Capture the Flag engine will be provided to score students as they capture flags. More difficult challenges will be worth more points. In this offensive exercise, challenges range from local privilege escalation to remote exploitation on both Linux and Windows systems, as well as networking attacks and other challenges related to the course material.


# FOR500: Windows Forensic Analysis	GCFE	Ovie Carroll Phill Moore #

Master Windows Forensics - "You Can't Protect What You Don't Know About."

All organizations must prepare for cyber-crime occurring on their computer systems and within their networks. Demand has never been greater for analysts who can investigate crimes such as fraud, insider threats, industrial espionage, employee misuse, and computer intrusions. Government agencies increasingly require trained media exploitation specialists to recover vital intelligence from Windows systems. To help solve these cases, SANS is training a new cadre of the world's best digital forensic professionals, incident responders, and media exploitation experts capable of piecing together what happened on computer systems second by second.


FOR500: Windows Forensic Analysis focuses on building in-depth digital forensics knowledge of Microsoft Windows operating systems. You can't protect what you don't know about, and understanding forensic capabilities and artifacts is a core component of information security. You will learn how to recover, analyze, and authenticate forensic data on Windows systems, track particular user activity on your network, and organize findings for use in incident response, internal investigations, and civil/criminal litigation. You will be able to use your new skills to validate security tools, enhance vulnerability assessments, identify insider threats, track hackers, and improve security policies. Whether you know it or not, Windows is silently recording an unbelievable amount of data about you and your users. FOR500 teaches you how to mine this mountain of data.

Proper analysis requires real data for students to examine. The completely updated FOR500 course trains digital forensic analysts through a series of new hands-on laboratory exercises that incorporate evidence found on the latest Microsoft technologies (Windows 7, Windows 8/8.1, Windows 10, Office and Office365, Cloud Storage, SharePoint, Exchange, Outlook). Students leave the course armed with the latest tools and techniques and prepared to investigate even the most complicated systems they might encounter. Nothing is left out - attendees learn to analyze everything from legacy Windows 7 systems to just-discovered Windows 10 artifacts.

FOR500: Windows Forensic Analysis will teach you to:

Conduct in-depth forensic analysis of Windows operating systems and media exploitation focusing on Windows 7, Windows 8/8.1, Windows 10, and Windows Server 2008/2012/2016
Identify artifact and evidence locations to answer critical questions, including application execution, file access, data theft, external device usage, cloud services, geolocation, file download, anti-forensics, and detailed system usage
Focus your capabilities on analysis instead of on how to use a particular tool
Extract critical answers and build an in-house forensic capability via a variety of free, open-source, and commercial tools provided within the SANS Windows SIFT Workstation
FOR500 is continually updated. The course starts with an intellectual property theft and corporate espionage case that took over six months to create. You work in the real world, so your training should include real-world practice data. Our instructor development team used incidents from their own investigations and experiences to create an incredibly rich and detailed scenario designed to immerse students in an actual investigation. The case demonstrates the latest artifacts and technologies an investigator might encounter while analyzing Windows systems. The detailed workbook shows step-by-step the tools and techniques that each investigator should employ to solve a forensic case.

Windows Forensics Course Topics:

Windows Operating Systems Focus (Windows 7, Windows 8/8.1, Windows 10, Server 2008/2012/2016)
Windows File Systems (NTFS, FAT, exFAT)
Advanced Evidence Acquisition Tools and Techniques
Registry Forensics
Shell Item Forensics
Shortcut Files (LNK) - Evidence of File Opening
Shellbags - Evidence of Folder Opening
JumpLists - Evidence of File Opening/Program Exec
Windows Artifact Analysis
Facebook, Gmail, Hotmail, Yahoo Chat, and Webmail Analysis
EmailMicrosoft Office Document Analysis
System Resource Usage Database
Windows 10 Timeline Database
Windows Recycle Bin Analysis
File and Picture Metadata Tracking and Examination
Ten Different Application Execution Artifacts Including Several New to Windows 10
Email Forensics (Host, Server, Web), Including Office 365
Event Log File Analysis
Firefox, Chrome, Edge, and Internet Explorer Browser Forensics
Deleted Registry Key and File Recovery
Recovering Missing Data From Registry and ESE Database .Log Files
String Searching and File Carving
Examination of Cases Involving Windows 7, Windows 8/8.1, and Windows 10
Media Analysis and Exploitation Involving:
Tracking User Communications Using a Windows PC (Email, Chat, IM, Webmail)
Identifying If and How a Suspect Downloaded a Specific File to the PC
Determining the Exact Time and Number of Times a Suspect Executed a Program
Showing When Any File Was First and Last Opened by a Suspect
Determining If a Suspect Had Knowledge of a Specific File
Showing the Exact Physical Location of the System
Tracking and Analyzing External and USB Devices
Showing How the Suspect Logged on to the Machine via the Console, RDP, or Network
Recovering and Examining Browser Artifacts, Even Those Used in a Private Browsing Mode
Discovering Utilization of Anti-Forensics, Including File Wiping, Time Manipulation, and Program Removal
The Course Is Fully Updated to Include Latest Windows 7, 8, 8.1, 10, and Server 2008/2012/2016 Techniques


The Windows Forensic Analysis course starts with an examination of digital forensics in today's interconnected environments and discusses challenges associated with mobile devices, tablets, cloud storage, and modern Windows operating systems. We will discuss how modern hard drives, such as Solid State Devices (SSD), can affect the digital forensics acquisition process and how analysts need to adapt to overcome the introduction of these new technologies.

Hard drive sizes are increasingly difficult to handle appropriately in digital cases. Being able to acquire data in an efficient and forensically sound manner is crucial to every investigator today. Most fundamental analysts can easily image a hard drive using a write blocker. In this course, we will review the core techniques while introducing new triage-based acquisition and extraction capabilities that will increase the speed and efficiency of the acquisition process. We will demonstrate how to acquire memory, the NTFS MFT, Windows logs, Registry, and critical files that will take minutes to acquire instead of the hours or days currently spent on acquisition.

We will also begin processing our collected evidence using stream-based and file-carving-based extraction capabilities that employ both commercial and open-source tools and techniques. Seasoned investigators will need to know how to target the specific data that they need to begin to answer fundamental questions in their cases.

Exercises
Install the Windows SIFT Workstation and get an orientation about its operations
Image a hard drive for evidence using a WiebeTech UltraDock Write Blocker
Undertake advanced triage-based acquisition and imaging - rapid acquisition
Mount acquired disk images and evidence
Carve important files from free space
Recover critical user data from the pagefile, hibernation file, memory images, and unallocated space
Recover chat sessions, web-based email, social networking, and private browsing
CPE/CMU Credits: 6

Topics
Windows Operating System Componets
Key Differences in Windows Versions
Windows 7 and Higher
Microsoft Server Variations
Core Forensic Principles
Analysis Focus
Key Questions
Determining Your Scope
Live Response and Triage-Based Acquisition Techniques
RAM Acquisition
Registry Extraction
Creating Custom Content Images
Triage-Based Forensics - Fast Forensic Acquisition - Key Files
Following the Order of Volatility
Triage via Custom Content Extraction
Acquisition Review with Write Blocker
Advanced Acquisition Challenges
Detecting Encrypted Drives
SSD vs. Standard Platter-Based Hard Drives
SSD Acquisition Concerns
Windows Image Mounting and Examination
NTFS File System Overview
Document and File Metadata
File Carving
Principles of Data Carving
Loss of File System Metadata
File Carving Tools
Custom Carving Signatures
Memory, Pagefile, and Unallocated Space Analysis
Artifact Recovery and Examination
Facebook Live, MSN Messenger, Yahoo, AIM, GoogleTalk Chat
IE8-11, Edge, Firefox, Chrome InPrivate/Recovery URLs
Yahoo, Hotmail, G-Mail, Webmail, Email


Our journey continues with the Windows Registry, where the digital forensic investigator will learn how to discover critical user and system information pertinent to almost any investigation. Each examiner will learn how to navigate and examine the Registry to obtain user profile data and system data. The course teaches forensic investigators how to prove that a specific user performed keyword searches, ran specific programs, opened and saved files, perused folders, and used removable devices.

Throughout the section, investigators will use their skills in a real hands-on case, exploring the evidence and analyzing evidence.

Exercises
Profile a computer system using evidence found in the Registry
Conduct a detailed profile of user activity using Registry evidence
Examine which programs a user recently executed by examining Registry-based UserAssist, AppCompability, Amcache, RecentApps, BAM/DAM, and others
Determine which files a user recently opened via the RecentDocs keys in the Registry
Examine recently opened Office 365 files and determine first/last open times
Find folders recently accessed by a user via the Open/Save keys in the Registry
CPE/CMU Credits: 6

Topics
Registry Forensics In-Depth

Registry Core
Hives, Keys, and Values
Registry Last Write Time
MRU Lists
Deleted Registry Key Recovery
Identify Dirty Registry Hives and Recover Missing Data
Rapidly Search and Timeline Multiple Hives
Profile Users and Groups
Discover Usernames and the SID Mapped to Them
Last Login
Last Failed Login
Login Count
Password Policy
Core System Information
Identify Current Control Set
System Name and Version
Timezone
Local IP Address Information
Wireless/Wired/3G Networks
Connected Network Auditing and Device Geolocation
Network Shares and Offline Caching
Last Shutdown Time
Registry-Based Malware Persistence Mechanisms
User Forensic Data
Evidence of File Downloads
Office and Office 365 File History Analysis
Windows 7, Windows 8/8.1, Windows 10 Search History
Typed Paths and Directories
Recent Documents (RecentDocs)
Open-> Save/Run Dialog Boxes Evidence
Application Execution History via UserAssist, Shimcache, RecentApps, AmCache, and BAM/DAM
Tools Used
Registry Explorer
TZWork's CAFAE and YARU (Yet Another Registry Utility)


Being able to show the first and last time a file or folder was opened is a critical analysis skill. Utilizing shortcut (LNK), jump list, and Shellbag databases through the examination of SHELL ITEMS, we can quickly pinpoint which file or folder was opened and when. The knowledge obtained by examining SHELL ITEMS is crucial in tracking user activity in intellectual property theft cases internally or in tracking hackers.

Removable storage device investigations are often an essential part of performing digital forensics. We will show you how to perform in-depth USB device examinations on Windows 7, 8/8.1, and 10. You will learn how to determine when a storage device was first and last plugged in, its vendor/make/model, and even the unique serial number of the device used.

Exercises
Track USB and BYOD devices that were connected to the system via the Registry and file system
Determine first and last connected times of USB devices that are plugged into your system
Determine last removal time of USB devices that are plugged into your system
Use Shortcut (LNK) file analysis to determine first/last times a file was opened
Use Shellbag Registry Key Analysis to determine when a folder was accessed
Use a jump list examination to determine when files were accessed by specific programs
Unlock BitLocker-To-Go encrypted USB devices
CPE/CMU Credits: 6

Topics
Shell Item Forensics
Link/Shortcut Files (.lnk) - Evidence of File Opening
Windows7/Windows10 Jump Lists - Evidence of File Opening and Program Execution
Shellbag Analysis - Evidence of Folder Access
USB and Bring Your Own Device (BYOD) Forensic Examinations
Vendor/Make/Version
Unique Serial Number
Last Drive Letter
MountPoints2 - Last Drive Mapping Per User (Including Mapped Shares)
Volume Name and Serial Number
Username that Used the USB Device
Time of First USB Device Connection
Time of Last USB Device Connection
Time of Last USB Device Removal
Auditing BYOD Devices at Scale
Bitlocker -To-Go Encrypted USB Devices

Depending on the type of investigation and authorization, a wealth of evidence can be unearthed through the analysis of email files. Recovered email can bring excellent corroborating information to an investigation, and its informality often provides very incriminating evidence. It is common for users to have an email that exists locally on their workstation, on their company email server, in a private cloud, and in multiple webmail accounts.

Additional artifacts such as Windows Prefetch and AppcompatCache data are paramount to proving evidence of execution. The exciting Windows 10 Timeline database shows great promise in recording detailed user activity. Similarly, the System Resource Usage Monitor (SRUM), one of our newest digital artifacts, can help determine several important user actions, including network usage by cloud storage and backdoors, even after execution of counter-forensic programs.

Finally, Windows event log analysis has solved more cases than possibly any other type of analysis. Understanding the locations and content of these files is crucial to the success of any investigator. Many researchers overlook these records because they do not have adequate knowledge or tools to get the job done efficiently. This section arms each investigator with the core knowledge and capability to maintain this crucial skill for many years to come.

Exercises
Employ best-of-breed forensic tools to search for relevant email and file attachments in large data sets
Analyze message headers and gauge email authenticity using SPF and DKIM
Understand how Extended MAPI Headers can be used in an investigation
Effectively collect evidence from Exchange and Office365
Learn the latest on Unified Audit Logs in Office365
Search for Webmail and Mobile Email remnants
Understand key concepts like email object filtering, de-duplication, and message similarity
Use forensic software to recover deleted objects from email archives
Gain experience with a commercial email forensics and e-discovery tool
Perform data visualization and timeline analysis
Analyze document metadata present in email archives
Analyze the various versions of the Windows Recycle Bin
Analyze Windows Prefetch files to determine thousands of application execution times
Use the System Resource Usage Monitor (SRUM) to answer questions never before available in Windows forensics
Merge event logs and perform advanced filtering
Profile account usage and determine logon session length
Audit file and folder access
Identify evidence of time manipulation on a system
Supplement registry analysis with BYOD device auditing, including new Windows 10 events
Analyze historical records of wireless network associations and geolocate a device
CPE/CMU Credits: 6

Topics
Email Forensics
Evidence of User Communication
How Email Works
Email Header Examination
Email Authenticity
Determining a Sender's Geographic Location
Extended MAPI Headers
Host-Based Email Forensics
Exchange Recoverable Items
Exchange Evidence Acquisition and Mail Export
Exchange Compliance Search and eDiscovery
Unified Audit Logs in Office 365
Recovering Deleted Emails
Web and Cloud-Based Email
Email Searching and Examination
Mobile Email Remnants
Forensicating Additional Windows OS Artifacts
Windows Search Index Forensics
Extensible Storage Engine (ESE) Database Recovery and Repair
Thumbs.db and Thumbscache Files
Windows Prefetch Analysis (XP, Windows 7-Windows 10)
Windows Recycle Bin Analysis (XP, Windows 7- Windows 10)
Windows 10 Timeline Database
System Resource Usage Monitor (SRUM)
Connected Networks, Duration, and Bandwidth Usage
Applications Run and Bytes Sent/Received Per Application
Application Push Notifications
Energy Usage
Windows Event Log Analysis
Events Logs that Matter to a Digital Forensic Investigator
EVTX and EVT Log Files
Track Account Usage including RDP, Brute Force Password Attacks, and Rogue Local Account Usage
Audit and Analyze File and Folder Access
Prove System Time Manipulation
Track Bring Your Own Device (BYOD) and External Devices
Geo-locate a Device via Event Logs


With the increasing use of the web and the shift toward web-based applications and cloud computing, browser forensic analysis is a critical skill. During this section, the investigator will comprehensively explore web browser evidence created during the use of Internet Explorer, Edge, Firefox, and Google Chrome. The hands-on skills taught here, such as SQLite and ESE database parsing, allow investigators to extend these methods to nearly any browser they encounter. The analyst will learn how to examine every significant artifact stored by the browser, including cookies, visit and download history, Internet cache files, browser extensions, and form data. We will show you how to find these records and identify the common mistakes investigators make when interpreting browser artifacts. You will also learn how to analyze some of the more obscure (and powerful) browser artifacts, such as session restore, tracking cookies, zoom levels, predictive site prefetching, and private browsing remnants.

Throughout the section, investigators will use their skills in real hands-on cases, exploring evidence created by Chrome, Firefox, Edge, Internet Explorer, and Tor correlated with other Windows operating system artifacts.

Exercises
Track a suspect's activity in browser history and cache files and identify local file access
Analyze artifacts found within the Extensible Storage Engine (ESE) database format
Examine which files a suspect downloaded
Determine URLs that suspects typed, clicked on, bookmarked, or merely popped up while they were browsing
Parse automatic crash recovery files to reconstruct previous browser sessions
Leverage Google Analytics cookies to profile user behaviors
Learn to manually parse SQLite databases from Firefox and Chrome
Identify anti-forensics activity and re-construct private browsing sessions
Investigate browser auto-complete data
CPE/CMU Credits: 6

Topics
Browser Forensics
History
Cache
Searches
Downloads
Understanding Browser Timestamps
Internet Explorer
IE Forensic File Locations
History files: Index.dat and WebCache.dat
Cache Recovery and Timestamps
Microsoft Universal Application Artifact
Download History
Credentials Stored in the Windows Vault
Internet Explorer Tab Recovery Analysis
Cross-Device Synchronization, Including Tabs, History, Favorites, and Passwords
Edge
History, Cache, Cookies, Download History, and Session Recovery
Spartan.edb
Reading List, WebNotes, Top Sites, and SweptTabs
Firefox
Firefox Artifact Locations
Mork Format and SQLite FilesFirefox Quantum Updates
Download History
Firefox Cache2 Examinations
Detailed Visit Type Data
Form History
Session Recovery
Firefox Extensions
Chrome
Chrome File Locations
Correlating URLs and Visits Tables for Historical Context
History and Page Transition Types
Chrome Preferences File
Web Data, Shortcuts, and Network Action Predictor Databases
Chrome Timestamps
Cache Examinations
Download History
Chrome Session Recovery
Chrome Profiles Feature
Identifying Cross-Device Chrome Synchronization
Private Browsing and Browser Artifact Recovery
IE and Edge InPrivate Browsing
Chrome and Firefox Private Browsing
Investigating the Tor Browser
Identifying Selective Database Deletion
SQLite and ESE Database CarvingExamination of Browser Artifacts
Super Cookies
DOM and Web Storage Objects
Google Analytics and Universal Cookies
Rebuilding Cached Web Pages
Browser Ancestry
Tools Used
Nirsoft Tools
SQLite Parsers
ESE DatabaseView
Hindsight

Nothing will prepare you more as an investigator than a full hands-on challenge that requires you to use the skills and knowledge presented throughout the week. In the morning, you will have the option to work in teams on a real forensic case. Students will be provided new evidence to analyze, and the exercise will step you through the entire case flow, including proper acquisition, analysis, and reporting in preparation for a possible trial. Teams will work on the case with the objective of profiling computer usage and discovering the most critical pieces of evidence to present.

This complex case will involve an investigation into one of the most recent versions of the Windows Operating System. The evidence is real and provides the most realistic training opportunity currently available. Solving the case will require that students use all of the skills gained from each of the previous sections.

The section will conclude with a mock trial involving presentations of the evidence collected. The team with the best in-class presentation and short write-up wins the challenge...and the case!

Exercises
Windows 10 Forensic Challenge
Two Additional Take Home Exercises to Hone Your Skills!
CPE/CMU Credits: 6

Topics
Digital Forensic Case
Analysis
Begin with a New Set of Evidence
Following Evidence Analysis Methods Discussed Throughout the Week and Find Critical Evidence
Examine Memory, Registry, Chat, Browser, Recovered Files, and More
Reporting
Focus and Submit the Top Three Pieces of Evidence Discovered and Discuss What They Prove Factually
Document One of the Submitted Pieces of Evidence for Potential Examination During the Mock Trial
Presentation
Each Team Will Be Asked to Prepare the following:
Executive Summary
Short Presentation
Conclusion
The Team Voted to Have the Best Argument and Presentation Proving Its Case Wins the Challenge


# FOR572: Advanced Network Forensics: Threat Hunting, Analysis, and Incident Response	GNFA	Philip Hagen #

Take your system-based forensic knowledge onto the wire. Incorporate network evidence into your investigations, provide better findings, and get the job done faster.

It is exceedingly rare to work any forensic investigation that doesn't have a network component. Endpoint forensics will always be a critical and foundational skill for this career but overlooking their network communications is akin to ignoring security camera footage of a crime as it was committed. Whether you handle an intrusion incident, data theft case, employee misuse scenario, or are engaged in proactive adversary discovery, the network often provides an unparalleled view of the incident. Its evidence can provide the proof necessary to show intent, uncover attackers that have been active for months or longer, or may even prove useful in definitively proving a crime actually occurred.


FOR572: ADVANCED NETWORK FORENSICS: THREAT HUNTING, ANALYSIS AND INCIDENT RESPONSE was designed to cover the most critical skills needed for the increased focus on network communications and artifacts in today's investigative work, including numerous use cases. Many investigative teams are incorporating proactive threat hunting to their skills, in which existing evidence is used with newly-acquired threat intelligence to uncover evidence of previously-unidentified incidents. Others focus on post-incident investigations and reporting. Still others engage with an adversary in real time, seeking to contain and eradicate the attacker from the victim's environment. In these situations and more, the artifacts left behind from attackers' communications can provide an invaluable view into their intent, capabilities, successes, and failures.

In FOR572, we focus on the knowledge necessary to examine and characterize communications that have occurred in the past or continue to occur. Even if the most skilled remote attacker compromised a system with an undetectable exploit, the system still has to communicate over the network. Without command-and-control and data extraction channels, the value of a compromised computer system drops to almost zero. Put another way: Bad guys are talking - we'll teach you to listen.



This course covers the tools, technology, and processes required to integrate network evidence sources into your investigations, with a focus on efficiency and effectiveness. You will leave this week with a well-stocked toolbox and the knowledge to use it on your first day back on the job. We will cover the full spectrum of network evidence, including high-level NetFlow analysis, low-level pcap-based dissection, ancillary network log examination, and more. We cover how to leverage existing infrastructure devices that may contain months or years of valuable evidence as well as how to place new collection platforms while an incident is underway.


Whether you are a consultant responding to a client's site, a law enforcement professional assisting cybercrime victims and seeking prosecution of those responsible, an on-staff forensic practitioner, or a member of the growing ranks of threat hunters, this course offers hands-on experience with real-world scenarios that will help take your work to the next level. Previous SANS SEC curriculum students and other network defenders will benefit from the FOR572 perspective on security operations as they take on more incident response and investigative responsibilities. SANS DFIR alumni can take their existing operating system or device knowledge and apply it directly to the network-based attacks that occur daily. In FOR572, we solve the same caliber of real-world problems without the use of disk or memory images.

Most of FOR572's hands-on labs have been developed together with the latest version of FOR508, Advanced Incident Response, Threat Hunting, and Digital Forensics. In these shared scenarios, you'll quickly see a hybrid approach to forensic examination that includes both host and network artifacts is ideal. Although our primary focus is on the network side of that equation, we will point out areas where the host perspective could provide additional context, or where the network perspective gives deeper insight. Both former and future FOR508 students will appreciate the nexus between these extensive evidence sets.

The hands-on labs in this class cover a wide range of tools and platforms, including the venerable tcpdump and Wireshark for packet capture and analysis; NetworkMiner for artifact extraction; and open-source tools including nfdump, tcpxtract, tcpflow, and more. Newly added tools in the course include the free and open-source SOF-ELK(R) platform - a VMware appliance pre-configured with a tailored configuration of the Elastic stack. This "big data" platform includes the Elasticsearch storage and search database, the Logstash ingest and parsing engine, and the Kibana graphical dashboard interface. Together with the custom SOF-ELK configuration files, the platform gives forensicators a ready-to-use platform for log and NetFlow analysis. For full-packet analysis and hunting at scale, the free and open-source Moloch platform is also covered and used in a hands-on lab. Through all of the in-class labs, shell scripting skills are highlighted as quick and easy ways to rip through hundreds of thousands of data records.

FOR572 is truly an advanced course - we hit the ground running on day one. Bring your entire bag of skills: forensic techniques and methodologies, full-stake networking knowledge (from the wire all the way up to user-facing services), Linux shell utilities, and everything in between. They will all benefit you throughout the course material as you FIGHT CRIME. UNRAVEL INCIDENTS...ONE BYTE (OR PACKET) AT A TIME.


Advanced Network Forensics: Threat Hunting, Analysis and Incident Response Course Topics:


Foundational network forensics tools: tcpdump and Wireshark refresher
Packet capture applications and data
Unique considerations for network-focused forensic processes
Network evidence types and sources
Network architectural challenges and opportunities for investigators
Investigation OPSEC and footprint considerations
Network protocol analysis
Hypertext Transfer Protocol (HTTP)
Domain Name Service (DNS)
File Transfer Protocol (FTP)
Server Message Block (SMB) and related Microsoft protocols
Simple Mail Transfer Protocol (SMTP)
Commercial network forensic tools
Automated tools and libraries
NetFlow
Introduction
Collection approaches
Open-source NetFlow tools
Wireless networking
Capturing wireless traffic
Useful forensic artifacts from wireless traffic
Common attack methods and detection
Log data to supplement network examinations
Syslog
Microsoft Windows Event Forwarding
HTTP server logs
Firewalls, Intrusion Detection Systems (IDSes), and Network Security Monitoring (NSM) Platforms
Log collection, aggregation, and analysis
Web proxy server examination
Encryption
Introduction
Meddler-in-the-middle
Secure Sockets Layer (SSL) and Transport Layer Security (TLS)
Deep packet work
Network protocol reverse engineering
Payload reconstruction

Focus: Although many fundamental network forensic concepts align with those of any other digital forensic investigation, the network presents many nuances that require special attention. Today you will learn how to apply what you already know about digital forensics and incident response to network-based evidence. You will also become acclimated to the basic tools of the trade.


Network data can be preserved, but only if directly captured or documented while in transit. Whether tactical or strategic, packet capture methods are quite straightforward. You will re-acquaint yourself with tcpdump and Wireshark, some of the most common tools used to capture and analyze network packets, respectively. However, since long-term full-packet capture is still uncommon in most environments, many artifacts that can tell us about what happened on the wire in the past come from devices that manage network functions. You will learn about what kinds of devices can provide valuable evidence and at what level of granularity. We will walk through collecting evidence from one of the most common sources of network evidence - a web proxy server - then you'll go hands-on to find and extract stolen data from the proxy.

The Linux SIFT Workstation virtual machine, which has been loaded with network forensic tools, will be your primary toolkit for the week.



Exercises
Lab Environment Preparation
tcpdump and Wireshark Hands-On
Carve Exfiltrated Data
CPE/CMU Credits: 6

Topics
Web Proxy Server Examination
Role of a web proxy
Proxy solutions - commercial and open source
Squid proxy server
Configuration
Logging
Automated analysis
Cache extraction
Foundational Network Forensics Tools: tcpdump and Wireshark
tcpdump re-introduction
pcap file format
Berkeley Packet Filter (BPF)
Data reduction
Useful command-line parameters
Wireshark re-introduction
User interface
Display filters
Useful features for network forensic analysis
Network Evidence Acquisition
Three core types: full-packet capture, Logs, NetFlow
Capture devices: switches, taps, Layer 7 sources, NetFlow
Planning to capture: strategies; commercial and home-built platforms
Network Architectural Challenges and Opportunities
Challenges provided by a network environment
Future trends that will affect network forensics


FOCUS: There are countless network protocols that may be in use in a production network environment. We will cover those that are most likely to benefit the forensicator in typical casework, as well as several that help demonstrate analysis methods useful when facing new, undocumented, or proprietary protocols. By learning the "typical" behaviors of these protocols, we can more readily identify anomalies that may suggest misuse of the protocol for nefarious purposes. These protocol artifacts and anomalies can be profiled through direct traffic analysis as well as through the log evidence created by systems that have control or visibility of that traffic. While this affords the investigator with vast opportunities to analyze the network traffic, efficient analysis of large quantities of source data generally requires tools and methods designed to scale.


Knowing how protocols appear in their normal use is critical if investigators are to identify anomalous behaviors. By looking at some of the more frequently-used and high-impact network communication protocols, we will specifically focus on the ways in which they can be easily misused by an adversary or a malware author.

While no one course could ever exhaustively cover the dizzying list of protocols used in a typical network environment, you will build the skills needed to learn whatever new protocols may come your way. The ability to "learn how to learn" is critical, as new protocols are developed every day. Advanced adversaries also develop their own protocols. As you will see later in this class, successfully understanding and counteracting an adversary's undocumented protocol is a similar process to learning those you will see in this section.

Log data is one of the unsung heroes in the realm of network forensics. While the near-perfect knowledge that comes with full-packet capture seems ideal, it suffers from several shortfalls. It is often unavailable, as many organizations have not yet deployed or cannot deploy comprehensive collection systems. When they are in use, network capture systems quickly amass a huge volume of data, which is often difficult to process effectively and must be maintained in a rolling buffer covering just a few days or weeks. The increasing use of encryption for most network traffic also provides a significant barrier to analysis when using full-packet capture, leaving logs from a terminal point of the communication as the artifact with the most potential impact.

In this section, you will learn various logging mechanisms available to both endpoint and network transport devices. You will also learn how to consolidate log data from multiple sources, providing a broad corpus of evidence in one location. As the volume of log data increases, so does the need to consider automated analytic tools. You'll use the SOF-ELK(R) platform for post-incident log aggregation and analysis, bringing quick and decisive insight to a compromise investigation.



Exercises
HTTP Profiling
Firewall and Zeek NSM Analysis
SOF-ELK(R) Log Aggregation and Analysis
CPE/CMU Credits: 6

Topics
Hypertext Transfer Protocol (HTTP) Part 1: Protocol
Forensic value
Request/response dissection
Useful HTTP fields
HTTP tracking cookies
HTTP/2 artifacts
Artifact extraction
Hypertext Transfer Protocol (HTTP) Part 2: Logs
Log formats
Expanded mod_forensic logging
Analysis methods
Domain Name Service (DNS): Protocol and Logs
Architecture and core functionality
Tunneling
Fast flux and domain name generation algorithms (DGAs)
Logging methods
Amplification attacks
Firewall, Intrusion Detection System, and Network Security Monitoring Logs
Firewalls
Families of firewall solutions
Additional features
Syntax and log formats
Intrusion Detection Systems (IDS) and Network Security Monitoring (NSM) Platforms
Rules and signatures
Families of IDS and NSM solutions
Zeek NSM
Basics and use cases
Logging
Signature engine
Logging Protocol and Aggregation
Syslog
Dual role: server and protocol
Source and collection platforms
Event dissection
rsyslog configuration
Microsoft Eventing
Deployment model and capabilities
Windows Event Forwarding
Architecture
Analysis mode
Log Data Collection, Aggregation, and Analysis
Benefits of aggregation: scale, scope, independent validation, efficiency
Known weaknesses and mitigations
Evaluating a comprehensive log aggregation platform
Elastic Stack and the SOF-ELK(R) Platform
Basics and pros/cons of the Elastic stack
SOF-ELK(R)
Inputs
Log-centric dashboards
Use as a data exploration platform

Focus: Network connection logging, commonly called NetFlow, may be the single most valuable source of evidence in network investigations. Many organizations have extensive archives of flow data due to its minimal storage requirements. Since NetFlow does not capture any content of the transmission, many legal issues with long-term retention are mitigated. Even without content, NetFlow provides an excellent means of guiding an investigation and characterizing an adversary's activities from pre-attack through operations. Whether for moving within a victim's environment or for data exfiltration, adversaries must move their quarry around through the use of various file access protocols. By knowing some of the more common file access and transfer protocols, a forensicator can quickly identify an attacker's theft actions.


Just as even a fuzzy photo can provide valuable leads in a traditional investigation, NetFlow data can provide a network forensicator with extremely high-value intelligence about network communications. The key to extracting that value is in knowing how to use NetFlow evidence to drive more detailed investigative activities.

NetFlow is also an ideal technology to use in baselining typical behavior of an environment, and therefore, deviations from that baseline that may suggest malicious actions. Threat hunting teams can also use NetFlow to identify prior connections consistent with newly-identified suspicious endpoints or traffic patterns.

In this section, you will learn the contents of typical NetFlow protocols, as well as common collection architectures and analysis methods. You'll also learn how to distill full-packet collections to NetFlow records for quick initial analysis before diving into more cumbersome pcap files.

You'll then examine the File Transfer Protocol, including how to reconstruct specific files from an FTP session. While FTP is commonly used for data exfiltration, it is also an opportunity to refine protocol analysis techniques, due to its multiple-stream nature.

Lastly, you'll explore a variety of the network protocols unique to a Microsoft Windows or Windows-compatible environment. Significant time will be spent exploring the SMB protocol, used for file transfers and countless other purposes in a Microsoft Windows domain structure. Attackers frequently use these protocols to "live off the land" within the victim's environment. By using existing and expected protocols, the adversary can hide in plain sight and avoid deploying malware that could tip off the investigators to their presence and actions.

Exercises
Visual NetFlow Analysis with SOF-ELK(R)
Tracking Lateral Movement with NetFlow
SMB Session Analysis and Reconstruction
CPE/CMU Credits: 6

Topics
NetFlow Collection and Analysis
Origins and evolution
NetFlow v5 and v9 protocols
Architectural components
NetFlow artifacts useful for examining encrypted traffic
Open-Source Flow Tools
Using open-source tool sets to examine NetFlow data
SiLK
nfcapd, nfpcapd, and nfdump
SOF-ELK: NetFlow ingestion and dashboards
File Transfer Protocol (FTP)
History and current use
Shortcomings in today's networks
Capture and analysis
File extraction
Microsoft Protocols
Architecture and capture positioning
Exchange/Outlook
SMB v2, and v3

Focus: Commercial tools are a mainstay in the network forensicator's toolkit. We'll explore the various roles that commercial tools generally fill, as well as how they can best be integrated to an investigative workflow. With the runaway adoption of wireless networking, investigators must also be prepared to address the unique challenges this technology brings to the table. However, regardless of the protocol being examined or budget used to perform the analysis, having a means of exploring full-packet capture is a necessity, and having a toolkit to perform this at scale is critical.


Commercial tools hold clear advantages in some situations a forensicator may typically encounter. Most commonly, this centers on scalability. Many open-source tools are designed for tactical or small-scale use. Whether using them for large-scale deployments or for specific niche functionalities, these tools can immediately address many investigative needs. You'll look at the typical areas where commercial tools in the network forensic realm tend to focus and discuss the value each may provide for your organizational requirements or those of your clients.

Additionally, we will address the forensic aspects of wireless networking. We will cover similarities with and differences from traditional wired network examinations, as well as what interesting artifacts can be recovered from wireless protocol fields. Some inherent weaknesses of wireless deployments will also be covered, including how attackers can leverage those weaknesses during an attack, and how they can be detected.

Finally, we will look at methods that can improve at-scale hunting from full-packet captures, even without commercial tooling. We will look at the open-source Moloch platform and how it can be used in live and forensic workflows. You'll receive a ready-to-use Moloch virtual machine and load source data from an incident we previously investigated, seeking ground truth from the previously-captured full-packet data.

Exercises
Commercial Network Forensic Tools
Using Command-Line Tools for Analysis
Network Forensic Analysis Using Moloch
CPE/CMU Credits: 6

Topics
Simple Mail Transfer Protocol (SMTP)
Lifecycle of an email message
Adaptations and extensions
Commercial Network Forensic Tools
Trade-offs between commercial and open-source solutions
Common commercial platforms that you may encounter
Using existing platforms and tools in a client environment

Wireless Network Forensics
Translating analysis of wired networks to the wireless domain
Capture methodologies: Hardware and Software
Useful protocol fields
Typical attack methodologies based on protection mechanisms
Automated Tools and Libraries
Common tools that can facilitate large-scale analysis and repeatable workflows
Libraries that can be linked to custom tools and solutions
Chaining tools together effectively
Full-Packet Hunting with Moloch
Moloch basics and architecture
Session awareness, filtering, typical forensic use cases


Focus: Advancements in common technology have made it easier to be a bad guy and harder for us to track them. Strong encryption methods are readily available and custom protocols are easy to develop and employ. Despite this, there are still weaknesses even in the most advanced adversaries' methods. As we learn what the attackers have deliberately hidden from us, we must operate carefully to avoid tipping our hats regarding the investigative progress - or the attacker can quickly pivot, nullifying our progress.


Encryption is frequently cited as the most significant hurdle to effective network forensics - for good reason. When properly implemented, encryption can be a brick wall in between an investigator and critical answers. However, technical and implementation weaknesses can be used to our advantage. Even in the absence of these weaknesses, the right analytic approach to encrypted network traffic can still yield valuable information about the content. We will discuss the basics of encryption and how to approach it during an investigation. The section will also cover flow analysis to characterize encrypted conversations.

We will also discuss undocumented protocols and the misuse of existing protocols for nefarious purposes. Specifically, we will address how to derive intelligence value with limited or nonexistent knowledge of the carrier protocol.

Finally, we will look at how common missteps can provide the attacker with clear insight to the forensicator's progress. This often leads to the attacker changing their tactics, confounding the investigator and even erasing all the progress made to that point. We'll address best practices on conducting investigations and in a compromised environment and ways to share hard-earned intelligence that mitigate the risks involved.



Exercises
SSL/TLS Profiling
Undocumented Protocol Features
Mini-Comprehensive Investigation
CPE/CMU Credits: 6

Topics
Encoding, Encryption, and SSL/TLS
Encoding algorithms
Encryption algorithms
Symmetric
Asymmetric
Profiling SSL/TLS connections with useful negotiation fields
Analytic mitigation
Perfect forward secrecy
Meddler-in-the-Middle (MITM)
Malicious uses
Benevolent uses
Common MITM tools
Artifacts of common MITM techniques
Network Protocol Reverse Engineering
Using known protocol fields to dissect unknown underlying protocols
Pattern recognition for common encoding algorithms
Addressing undocumented binary protocols
What to do after breaking the protocol

Investigation OPSEC and Threat Intel
Operational Security
Basic analysis can tip off attackers
How to mitigate risk without compromising quality
Intelligence
Plan to share smartly
Protect intelligence to mitigate risks

Focus: This section will combine all of what you have learned prior to and during this week. In groups, you will examine network evidence from a real-world compromise by an advanced attacker. Each group will independently analyze data, form and develop hypotheses, and present findings. No evidence from endpoint systems is available - only the network and its infrastructure.

Students will test their understanding of network evidence and their ability to articulate and support hypotheses through presentations made to the instructor and class. The audience will include senior-level decision makers, so all presentations must include executive summaries as well as technical details. Time permitting, students should also include recommended steps that could help to prevent, detect, or mitigate a repeat compromise.

Exercises
Capstone Lab
CPE/CMU Credits: 6

Topics
Network Forensic Case
Analysis using only network-based evidence
Determine the original source of an advanced attacker's compromise
Identify the attacker's actions while in the victim's environment
Confirm what data the attacker stole from the victim
Reporting
Present executive-level summaries of your findings at the end of the day-long lab
Document and provide low-level technical backup for findings
Establish and present a timeline of the attacker's activities



# LEG523: Law of Data Security and Investigations	GLEG	Benjamin Wright #

New: The global imperative for organizations to demonstrate a culture of data privacy
New: Invoking attorney-client privilege to maintain confidentiality of security assessments such as penetration tests
New: Court decision shows how to improve an official investigation using artificial intelligence.
Unique and indispensable training for General Data Protection Regulation Officers.
New: Form contract to invite outside incident responders - including police, contractors, National Guard, or civil defense agencies from anywhere in the world - to help with a cyber crisis.
New: The European Union's new General Data Protection Regulation and its impact worldwide.
New law on privacy, e-discovery, and data security is creating an urgent need for professionals who can bridge the gap between the legal department and the cybersecurity team. SANS LEG523 provides this unique professional training, including skills in the analysis and use of contracts, policies, and insurance security questionnaires.

This course covers the law of crime, policy, contracts, liability, compliance, cybersecurity, and active defense - all with a focus on electronically stored and transmitted records. It also teaches investigators how to prepare credible, defensible reports, whether for cyber crimes, forensics, incident response, human resource issues, or other investigations.

The Global Information Assurance Certification (GLEG) associated with LEG523 demonstrates to employers that you have absorbed the sophisticated content of this course and are ready to put it to use. This coveted GIAC certification distinguishes any professional - whether a cybersecurity specialist, auditor, lawyer, or forensics expert - from the rest of the pack. It also strengthens the credibility of forensics investigators as witnesses in court and can help a forensics consultant win more business. And the value of the certification will only grow in the years to come as law and security issues become even more interconnected.

The course also provides training and continuing education for many compliance programs under information security and privacy mandates such as GLBA, HIPAA, FISMA, GDPR, and PCI-DSS.

Each successive day of this five-day course builds upon lessons from the earlier days in order to comprehensively strengthen your ability to help your public or private sector enterprise cope with illegal hackers, botnets, malware, phishing, unruly vendors, data leakage, industrial spies, rogue or uncooperative employees, or bad publicity connected with cybersecurity. We cover topical stories, such as Home Depot's legal and public statements about payment card breach and the lawsuit by credit card issuers against Target's QSA and security vendor, Trustwave.

Recent updates to the course address hot topics such as legal tips on confiscating and interrogating mobile devices, the retention of business records connected with cloud computing and social networks like Facebook and Twitter, and analysis and response to the risks and opportunities surrounding open-source intelligence gathering.

Over the years this course has adopted an increasingly global perspective. Professionals from outside the United States attend LEG523 because there is no training like it anywhere else in the world. For example, a lawyer from the national tax authority in an African country took the course because electronic filings, evidence, and investigations have become so important to her work. International students help the instructor, U.S. attorney Benjamin Wright, constantly revise the course and include more content that crosses borders.

You Will Learn How To:

Choose words for better legal results in policies, contracts, and incidents
Implement processes that yield defensible policies on security, e-records, and investigations
Reduce risk in a world of vague laws on cyber crime and technology compliance
Carry out investigations so that they will be judged as ethical and credible
Persuade authorities that you and your organization responded responsibly to cybersecurity, privacy, and forensic challenges.


Section 1 is an introduction to cyber and data protection law. It serves as the foundation for discussions during the rest of the course. We will survey the general legal issues that must be addressed in establishing best information security practices, then canvass the many new laws on data security and evaluate cybersecurity as a field of growing legal controversy. The course section will cover computer crime and intellectual property laws when a network is compromised, as well as emerging topics such as honeypots. We will look at the impact of future technologies on law and investigations in order to help students factor in legal concerns when they draft enterprise data security policies. For example, students will debate what the words of an enterprise policy would mean in a courtroom. This course section also dives deep into the legal question of what constitutes a "breach of data security" for such purposes as notifying others about it. The course day includes a case study on the drafting of policy to comply with the Payment Card Industry Data Security Standard (PCI). Students will learn how to choose words more carefully and accurately when responding to cybersecurity questionnaires from regulators, cyber insurers, and corporate customers.


Cybersecurity and digital forensic professionals constantly deal with records and evidence, so they need a practical understanding of e-discovery and policies on the retention and destruction of data. Section 2 of the course places great emphasis on the law of evidence and records management. It teaches the necessity to apply a "legal hold" or "litigation hold" on records when controversy emerges. It helps technical and legal professionals learn to speak the same language as they assess how to find records and possibly disclose them in litigation or investigations.

Recognizing that investigators, like incident responders, collect and manage evidence that may later be needed in court or arbitration, this section teaches how the law evaluates digital evidence. It also introduces electronic contracting methods, in preparation for the extended discussion of technology contracts in the next course section. Students learn that effective contracting today requires thoughtful decisions on the policy for the retention of records like electronic mail and text messages.

Law and technology are changing quickly, and it is impossible for professionals to comprehend all the laws that apply to their work. But they can comprehend overarching trends in law, and they can possess a mindset for finding solutions to legal problems. A key goal of this section is to equip students with the analytical skills and tools to address technology law issues as they arise, both in the United States and around the world. Section 2 devotes much attention to European data protection laws. The analysis puts the General Data Protection Regulation (GDPR) into a historical context so that students can better understand how the new regulation is being interpreted. (See Benjamin Wright's white paper on the GDPR.)

The course is chock full of actual court case studies dealing with privacy, computer records, digital evidence, electronic contracts, regulatory investigations, and liability for shortfalls in security. The purpose of the case studies is to draw practical lessons that students can take back to their jobs and apply immediately.

Section 3 focuses on the essentials of contract law sensitive to the current requirements for security. Compliance with many of the new data security laws requires contracts. Because IT pulls together the products and services of many vendors, consultants, and outsourcers, enterprises need appropriate contracts to comply with Gramm-Leach-Bliley, HIPAA, GDPR, PCI-DSS, data breach notice laws, and other regulations.

This course day provides practical steps and tools that students can apply to their enterprises and includes a lab on writing contract-related documents relevant to the students''professional responsibilities. (The lab is an optional, informal "office hours" discussion with the instructor at the end of the day when the course is delivered live.) You will learn the language of common technology contract clauses and the issues surrounding those clauses, and become familiar with specific legal cases that show how different disputes have been resolved in litigation.

Recognizing that enterprises today operate increasingly on a global basis, the course teaches cases and contract drafting styles applicable to a multinational setting.

Contracts covered include agreements for software, consulting, nondisclosure, outsourced services, cyber insurance, penetration testing, and private investigation services (such as cyber incident response). Special attention is given to cloud computing issues. Students also learn how to exploit the surprising power of informal contract records and communications, including cybersecurity questionnaires and requests for InfoSec assurances.

Information security professionals and cyber investigators operate in a world of ambiguity, rapid change, and legal uncertainty. To address these challenges, this course section presents methods to analyze a situation and then act in a way that is ethical, defensible, and reduces risk. Lessons will be invaluable to the effective and credible execution of any kind of investigation, be it internal, government, consultant related, a security incident, or any other. The lessons also include methods and justifications for maintaining the confidentiality of an investigation.

Section 4 surveys white-collar fraud and other misbehaviors with an emphasis on the role of technology in the commission, discovery, and prevention of that fraud. It teaches cyber managers and auditors practical and case-study-driven lessons about the monitoring of employees and employee privacy.

IT is often expected to "comply: with many mandates, whether stated in regulations, contracts, internal policies, or industry standards (such as PCI-DSS). This course section teaches many broadly applicable techniques to help professionals establish that they and their organizations are in fact in compliance, or to reduce risk if they are not in perfect compliance. The course draws lessons from models such as the Sarbanes-Oxley Act and European Union guidelines for imposing fines under the GDPR.

As cybersecurity professionals take on more responsibility for controls throughout an enterprise, it is natural that they worry about fraud, which becomes a new part of their domain. Section 4 covers what fraud is, where it occurs, what the law says about it, and how it can be avoided and remedied.

Scattered through the course are numerous descriptions of actual fraud (or "insider threat") cases involving technology. The purpose is to acquaint the student with the range of modern business crimes, whether committed by executives, employees, suppliers, or whole companies. More importantly, Section 4 draws on the law of fraud and corporate misconduct to teach larger and broader lessons about legal compliance, ethical hacking, and proper professional conduct in difficult case scenarios.

Further, this course section will show students how to conduct forensic investigations involving social, mobile, and other electronic media. Students will learn how to improve the preservation and interpretation of digital evidence, such as evidence of a breach or other cyber event.

Knowing some rules of law is not the same as knowing how to deal strategically with real-world legal problems. Section 5 is organized around extended case studies in security law: break-ins, investigations, piracy, extortion, rootkits, phishing, botnets, espionage, and defamation. The studies lay out the chronology of events and critique what the good guys did right and what they did wrong. The goal is to learn to apply principles and skills to address incidents in your day-to-day work.

The course includes an in-depth review of legal responses to the major security breaches at TJX, Target, and Home Depot, and looks at how to develop a bring-your-own-device (BYOD) policy for an enterprise and its employees.

The skills learned are a form of crisis management, with a focus on how your enterprise will be judged in a courtroom, by a regulatory agency, or in a contract relationship. Emphasis will be on how to present your side of a story to others, such as law enforcement, Internet gatekeepers, or the public at large, so that a security incident does not turn into a legal and political fiasco.

In addition to case studies, the core material will include tutorials on relevant legislation and judicial decisions in such areas as privacy, negligence, contracts, e-investigations, computer crime, and active countermeasures.

LEG523 is increasingly global in its coverage, so although this course day centers on U.S. law, legal issues and the roles of government authorities outside the United States will also be examined.

At the end of Section 5 the instructor will discuss a few sample questions to help students prepare for the GIAC exam associated with this course (GLEG).

# ICS410: ICS/SCADA Security Essentials	GICSP	Justin Searle #

SANS has joined forces with industry leaders to equip security professionals and control system engineers with the cybersecurity skills they need to defend national critical infrastructure. ICS410: ICS/SCADA Security Essentials provides a foundational set of standardized skills and knowledge for industrial cybersecurity professionals. The course is designed to ensure that the workforce involved in supporting and defending industrial control systems is trained to keep the operational environment safe, secure, and resilient against current and emerging cyber threats.

The course will provide you with:

An understanding of industrial control system components, purposes, deployments, significant drivers, and constraints.
Hands-on lab learning experiences to control system attack surfaces, methods, and tools
Control system approaches to system and network defense architectures and techniques
Incident-response skills in a control system environment
Governance models and resources for industrial cybersecurity professionals.
When examining the greatest risks and needs in critical infrastructure sectors, the course authors looked carefully at the core security principles necessary for the range of tasks involved in supporting control systems on a daily basis. While other courses are available for higher-level security practitioners who need to develop specific skills such as industrial control system penetration testing, vulnerability analysis, malware analysis, forensics, secure coding, and red team training, most of these courses do not focus on the people who operate, manage, design, implement, monitor, and integrate critical infrastructure production control systems.

With the dynamic nature of industrial control systems, many engineers do not fully understand the features and risks of many devices. In addition, IT support personnel who provide the communications paths and network defenses do not always grasp the systems' operational drivers and constraints. This course is designed to help traditional IT personnel fully understand the design principles underlying control systems and how to support those systems in a manner that ensures availability and integrity. In parallel, the course addresses the need for control system engineers and operators to better understand the important role they play in cybersecurity. This starts by ensuring that a control system is designed and engineered with cybersecurity built into it, and that cybersecurity has the same level of focus as system reliability throughout the system lifecycle.

When these different groups of professionals complete this course, they will have developed an appreciation, understanding, and common language that will enable them to work together to secure their industrial control system environments. The course will help develop cyber-secure-aware engineering practices and real-time control system IT /OT support carried out by professionals who understand the physical effects of actions in the cyber world.

Takeaway: Students will develop and reinforce a common language and understanding of Industrial Control System (ICS) cybersecurity as well as the important considerations that come with cyber-to-physical operations within these environments. Each student will receive a programmable logic controller (PLC) device to keep. The PLC contains physical inputs and outputs that will be programmed in class and mapped to an operator interface, or HMI, also created in class. This improved hardware-enabled approach provides the necessary cyber-to-physical knowledge that allows students to better understand important ICS operational drivers and constraints that require specific safety protection, communications needs, system management approaches, and cybersecurity implementations. Essential terms, architectures, methodologies, and devices are all covered to build a common language for students from a variety of different roles.

CPE/CMU Credits: 6

Topics
Day 1 ICS Overview

Global Industrial Cybersecurity Professional (GICSP) Overview
Overview of ICS
Processes & Roles
Industries
Purdue Levels 0 and 1
Controllers and Field Devices
Programming Controllers
Exercise: Programming a PLC
Purdue Levels 2 and 3
HMIs, Historians, Alarm Servers
Specialized Applications and Master Servers
DCS and SCADA
Differences in Location and Latency
Exercise: Programming an HMI
IT & ICS Differences
ICS Life Cycle Challenges
Physical and Cyber Security
Secure ICS Network Architectures
ICS410 Reference Model
Design Example
Exercise: Architecting a Secure DCS

Takeaway: If you know the adversary's approaches to attacking an ICS environment, you will be better prepared to defend that environment. Numerous attack vectors exist within an ICS environment. Some are similar to traditional IT systems, while others are more specific to ICS. During Day 2, students will develop a better understanding of where these specific attack vectors exist and how to block them, starting at the lowest levels of the control network. Students will look at different technologies and communications used in Perdue Levels 0 and 1, the levels that are the most different from an IT network. Students will capture fieldbus traffic from the PLCs they programmed in day 1 and look at what other fieldbus protocols used in the industry. Later in the day, students will analyze network captures containing other control protocols that traverse Ethernet-only networks and TCP/IP networks, set up a simulated controller, and interact with it through a control protocol.

CPE/CMU Credits: 6

Topics
Day 2: Field Devices and Controllers

ICS Attack Surface
Threat Actors and Reasons for Attack
Attack Surface and Inputs
Vulnerabilities
Threat/Attack Models
Purdue Level 0 and 1
Purdue Level 0 and 1 Attacks
Control Things Platform
Exercise: Finding Passwords in EEPROM Dumps
Purdue Level 0 and 1 Technologies
Purdue Level 0 and 1 Communications
Fieldbus Protocol Families
Exercise: Exploring Fieldbus Protocols
Purdue Level 0 and 1 Defenses
Ethernet and TCP/IP
Ethernet Concepts
TCP/IP Concepts
Exercise: Network Capture Analysis
ICS Protocols over TCP/IP
Wireshark and ICS Protocols
Attacks on Networks
Exercise: Enumerating Modbus TCP


Takeaway: Day 3 will take students through the middle layers of control networks. Students will learn about different methods to segment and control the flow of traffic through the control network. Students will explore cryptographic concepts and how they can be applied to communications protocols and on devices that store sensitive data. Students will learn about the risks of using wireless communications in control networks, which wireless technologies are commonly used, and available defenses for each. After a hand-on network forensics exercise where students follow an attacker from phishing campaign to HMI breach, students will look at HMI, historian, and user interface technologies used in the middle to upper levels of the control network, namely Perdue Levels 2 and 3, while performing attacks on HMI web technologies and interfaces susceptible to password brute force attacks.

CPE/CMU Credits: 6

Topics
Day 3: Supervisory Systems

Enforcement Zone Devices
Firewalls and NextGen Firewalls
Data Diodes and Unidirectional Gateways
Understanding Basic Cryptography
Crypto Keys
Symmetric and Asymmetric Encryption
Hashing and HMACs
Digital Signatures
Wireless Technologies
Satellite and Cellular
Mesh Networks and Microwave
Bluetooth and Wi-Fi
Wireless Attacks and Defenses
3 Eternal Risks of Wireless
Sniffing, DoS, Masquerading, Rogue AP
Exercise: Network Forensics of an Attack
Purdue Level 2 and 3 Attacks
Historians and Databases
Exercise: Bypassing Auth with SQL Injection
HMI and UI Attacks
Web-based Attacks
Password Defenses
Exercise: Password Fuzzing

Takeaway: Students will learn essential ICS-related server and workstation operating system capabilities, implementation approaches, and system management practices. Students will receive and work with both Windows- and Linux-based virtual machines in order to understand how to monitor and harden these hosts from attack. Students will examine concepts that benefit ICS systems such as system hardening, log management, monitoring, alerting, and audit approaches, then look at some of the more common applications and databases used in ICS environments across multiple industries. Finally, students will explore attacks and defenses on remote access for control systems.

CPE/CMU Credits: 6

Topics
Day 4: Workstations and Servers

Patching ICS Systems
Patch Decision Tree
Vendors, CERTS, and Security Bulletins
Defending Microsoft Windows
Windows Services
Windows Security Policies and GPOs
Exercise: Baselining with PowerShell
Defending Unix and Linux
Differences with Windows
Daemons, SystemV, and SystemD
Lynis and Bastille
Endpoint Security Software
Antivirus and Whitelisting
Application Sandboxing and Containers
Exercise: Configuring Host-Based Firewalls
Event Logging and Analysis
Windows Event Logs and Audit Policies
Syslog and Logrotate
Exercise: Windows Event Logs
Remote Access Attacks
Attacks on Remote Access
Honeypots
Exercise: Finding Remote Access

Takeaway: Students will learn about the various models, methodologies, and industry-specific regulations that are used to govern what must be done to protect critical ICS systems. Key business processes that consider risk assessments, disaster recovery, business impact analysis, and contingency planning will be examined from the perspective of ICS environments. On this final course day, students will work together on an incident response exercise that places them squarely in an ICS environment that is under attack. This exercise ties together key aspects of what has been learned throughout the course and presents students with a scenario to review with their peers. Specific incident-response roles and responsibilities are considered, and actions available to defenders throughout the incident response cycle are explored. Students will leave with a variety of resources for multiple industries and will be well prepared to pursue the GICSP, an important ICS-focused professional certification.

CPE/CMU Credits: 6

Topics
Day 5: ICS Security Governance

Building an ICS Cyber Security Program
Starting the Process
Frameworks: ISA/IEC 62443, ISO/IEC 27001, NIST CSF
Using the NIST CSF
Creating ICS Cyber Security Policy
Policies, Standards, Guidance, and Procedures
Culture and Enforcement
Examples and Sources
Disaster Recovery
DR and BCP Programs
Modification for Cyber Security Incidents
Measuring Cyber Security Risk
Quantitative vs Qualitative
Traditional Models
Minimizing Subjectivity
Incident Response
Six Step Process
Exercise: Incident Response Tabletop Exercise
Final Thoughts and Next Steps
Other ICS Courses by SANS
Other SANS Curriculums and Courses
Netwars

# Core NetWars Tournament - Add-on #
(FREE with any 4-6 Day SANS Course Registration)	Bryce Galbraith

NetWars Levels:
Level 1 - Played on local Linux image without root
Level 2 - Played on local Linux image with root
Level 3 - Attack a DMZ
Level 4 - Pivot to intranet
Level 5 - Master of your domain... castle versus castle
Topics Include:
Vulnerability Assessment
Packet Analysis
Penetration Testing
System Hardening
Malware Analysis
Digital Forensics and Incident Response

SEC530: Defensible Security Architecture and Engineering

NOTE: The term "architecture" is interpreted differently by different organizations and in various regions of the world. This course focuses on strategic and technical application and use cases, including fine-tuning and implementing various infrastructure components and cyber defense techniques. If you are expecting the course to focus exclusively on strategic solution placement and use cases, the course is not for you.

SEC530: Defensible Security Architecture and Engineering is designed to help students establish and maintain a holistic and layered approach to security. Effective security requires a balance between detection, prevention, and response capabilities, but such a balance demands that controls be implemented on the network, directly on endpoints, and within cloud environments. The strengths and weaknesses of one solution complement another solution through strategic placement, implementation, and fine-tuning.

To address these issues, this course focuses on combining strategic concepts of infrastructure and tool placement while also diving into their technical application. We will discuss and identify what solutions are available and how to apply them successfully. Most importantly, we'll evaluate the strengths and weaknesses of various solutions and how to layer them cohesively to achieve defense-in-depth.

The changing threat landscape requires a change in mindset, as well as a repurposing of many devices. Where does this leave our classic perimeter devices such as firewalls? What are the ramifications of the "encrypt everything" mindset for devices such as Network Intrusion Detection Systems?

In this course, students will learn the fundamentals of up-to-date defensible security architecture and how to engineer it. There will be a heavy focus on leveraging current infrastructure (and investment), including switches, routers, and firewalls. Students will learn how to reconfigure these devices to significantly improve their organizations' prevention capabilities in the face of today's dynamic threat landscape. The course will also delve into the latest technologies and their capabilities, strengths, and weaknesses. You will come away with recommendations and suggestions that will aid in building a robust security infrastructure.

While this is not a monitoring course, it will dovetail nicely with continuous security monitoring, ensuring that security architecture not only supports prevention but also provides the critical logs that can be fed into a Security Information and Event Management (SIEM) system in a Security Operations Center.

Multiple hands-on labs conducted daily will reinforce key points in the course and provide actionable skills that students will be able to leverage as soon as they return to work.


This first section of the course describes hardening systems and networks, beginning with the overall network architecture and layers. To quote Richard Bejtlich's The Tao of Network Security Monitoring, defensible networks "encourage, rather than frustrate, digital self-defense."

The section begins with an overview of traditional network and security architectures and their common weaknesses. The defensible security mindset is "build it once, build it right." All networks must perform their operational functions effectively, and security can complement this goal. It is much more efficient to bake security in at the outset than to retrofit it later.

The discussion will then turn to lower layer networking concepts, including many "ripped from the headlines" tips the co-authors have successfully deployed in the trenches to harden infrastructure in order to prevent and detect modern attacks. Examples include the use of private VLANs, which effectively kills the malicious client-to-client pivot, and 802.1X and NAC, which mitigate rogue devices. Specific Cisco IOS syntax examples are provided to harden switches.

Exercises
Egress Analysis: The focus is on understanding how attackers exfiltrate data and how to prevent and detect exfiltration.
Cisco Passwords: Default settings can lead to a major compromise. This lab focuses on the impact of not changing default settings on network infrastructure.
Identifying Layer 2 Attacks: Network security has increased, yet layer 2 attacks still are possible in a modern organization. The focus of this lab is on identifying layer 2 attacks.
Flow Analysis: This lab is about understanding the various forms of flow data and how to properly use them to identify unauthorized or anomalous activity
CPE/CMU Credits: 6

Topics
Traditional Security Architecture Deficiencies
Emphasis on Perimeter/Exploitation
Lack of a True Perimeter ("De-perimeterization" as a Result of Cloud/Mobile)
The Internet of Things
Predominantly Network-centric
Defensible Security Architecture
Mindset
Presumption of Compromise
De-perimeterization
Predominantly Network-centric
Models
Zero-Trust Model (Kindervag - Forrester)
Intrusion Kill Chain
Diamond Model of Intrusion Analysis
Software-defined Networking and Virtual Networking
Micro-Segmentation
Threat, Vulnerability, and Data Flow Analysis
Threat Vector Analysis

Data Ingress Mapping
Data Exfiltration Analysis

Data Egress Mapping
Detection Dominant Design
Attack Surface Analysis
Visibility Analysis
Layer 1 Best Practices
Network Closets
Penetration Testing Dropboxes
USB Keyboard Attacks (Rubber Ducky)
Layer 2 Best Practices
VLANs
Hardening
Private VLANs
Layer 2 Attacks and Mitigation
NetFlow
Layer 2 and 3 NetFlow
NetFlow, Sflow, Jflow, VPC Flow, Suricata and Endpoint Flow

This section develops the discussion on hardening infrastructure and moves on to concepts such as routing devices, firewalls, and application proxies. Actionable examples are provided for hardening routers, with specific Cisco IOS commands to perform each step.

The section then continues with a deep dive on IPv6, which currently accounts for 23 percent of Internet backbone traffic, according to Google, while simultaneously being used and ignored by most organizations. We will provide deep background on IPv6, discuss common mistakes (such as applying an IPv4 mindset to IPv6), and provide actionable solutions for securing the protocol. The section wraps up with a discussion on firewalls and application proxies.

Exercises
Auditing Router Security: The focus of this lab is on identifying and mitigating security issues in routers.
Router SNMP Security: In this lab, students will interact with cloud routers and perform attacks against SNMP to understand them and, ultimately, to remove the threat
IPv6: The Next Generation Internet Protocol, also known as IPv6, is often ignored and misunderstood. This lab allows students to interact with IPv4 and IPv6 to be more familiar with some of the differences.
Proxy Power: Proxies have immense capabilities in dealing with malware and command and control channels. This lab walks students through what would happen to malware phoning home based on the different ways a proxy can be configured.
Bonus Lab: The end of the day features a router lab in which students combine multiple components of book 1 and book 2 in a live-fire configuration and tuning of routers.
CPE/CMU Credits: 6

Topics
Layer 3: Router Best Practices

CIDR and Subnetting
Layer 3 Attacks and Mitigation
IP Source Routing
ICMP Attacks
Unauthorized Routing Updates
Securing Routing Protocols
Unauthorized Tunneling (Wormhole Attack)
Layer 2 and 3 Benchmarks and Auditing Tools
Baselines
CISecurity
Cisco's Best Practices
Cisco Autosecure
DISA STIGs
Nipper-ng
Securing SNMP
SNMP Community String Guessing
Downloading the Cisco IOS Config via SNMP
Hardening SNMP
SNMPv3
Securing NTP
NTP Authentication
NTP Amplification Attacks
Bogon Filtering, Blackholes, and Darknets
Bogon Filtering
Monitoring Darknet Traffic
Building an IP Blackhole Packet Vacuum
IPv6
Dual-Stack Systems and Happy Eyeballs
IPv6 Extension Headers
IPv6 Addressing and Address Assignment
Securing IPv6
IPv6 Firewall Support
Scanning IPv6
IPv6 Tunneling
IPv6 Router Advertisement Attacks and Mitigation
VPN
Path MTU Issues
Fragmentation Issues Commonly Caused by VPN
Layer 3/4 Stateful Firewalls
Router ACLs
Linux and BSD Firewalls
pfSense
Stateful
Proxy
Web Proxy
SMTP Proxy

Augmenting with Phishing Protection and Detection Mechanisms
Explicit vs. Transparent
Forward vs. Reverse

Organizations own or have access to many network-based security technologies, ranging from Next-Generation Firewalls to web proxies and malware sandboxes. Yet the effectiveness of these technologies is directly affected by their implementation. Too much reliance on built-in capabilities like application control, antivirus, intrusion prevention, data loss prevention, or other automatic evil-finding deep packet inspection engines leads to a highly preventative-focused implementation, with huge gaps in both prevention and detection.

This section focuses on using application-layer security solutions that an organization already owns with a modern mindset. By thinking outside the box, even old controls like a spam appliance can be used to catch modern attacks such as phishing via cousin domains and other spoofing techniques. And again, by engineering defenses for modern attacks, both prevention and detection capabilities gain significantly.

Exercises
Network Security Monitoring: Intrusion detection alerts and network metadata provide a holistic approach to knowing thyself and identifying unauthorized activity. This lab focuses on detecting malware operating over the network with NSM.
NSM Architecture and Engineering: In this lab, students will learn how to place and implement NSM technologies for proper visibility and application/protocol awareness.
Encryption Considerations; Network encryption protects data from being observed both by attackers and defenders. This lab focuses on how defenders can interact with TLS connections to gain back visibility for inspection in proxies, NSM, NGFW, and other solutions.
CPE/CMU Credits: 6

Topics
NGFW
Application Filtering
Implementation Strategies
NIDS/NIPS
IDS/IPS Rule Writing
Snort
Suricata
Bro
Network Security Monitoring
Power of Network Metadata
Know Thy Network
Sandboxing
Beyond Inline
Integration with Endpoint
Feeding the Sandbox Potential Specimens
Malware Detonation Devices
Encryption
The "Encrypt Everything" Mindset

Internal and External
Free SSL/TLS Certificate Providers
SSL/SSH Inspection
SSL/SSH Decrypt Dumps
SSL Decrypt Mirroring
Certificate Pinning

Malware Pins
HSTS
Crypto Suite Support

Qualys SSL Labs
Secure Remote Access
Access into Organization
Dual Factor for All Remote Access (and More)

Google Authenticator/TOTP: Open Authentication
IPSec VPNs
SSH VPNs
SSL/TLS VPN
Jump Boxes
Distributed Denial-of-Service
Impact of Internet of Things
Types of Attacks
Mitigation Techniques

Organizations cannot protect something they do not know exists. The problem is that critical and sensitive data exist all over. Complicating this even more is that data are often controlled by a full application stack involving multiple services that may be hosted on-premise or in the cloud.

This section focuses on identifying core data where they reside and how to protect those data. Protection includes using data governance solutions and full application stack security measures such as web application firewalls and database activity monitoring, as well as keeping a sharp focus on securing the systems hosting core services such as on-premise hypervisors, cloud computing platforms, and container services such as Docker.

The data-centric security approach focuses on what is core to an organization and prioritizes security controls around it. Why spend copious amounts of time and money securing everything when controls can be optimized and focused on securing what matters? Let's face it: Some systems are more critical than others.

Exercises
Securing Web Applications: In this lab, students will identify the prevention and detection capabilities that web application firewalls provide, and also learn where they can be evaded. Then changes will be applied to block and detect evasion techniques.

Discovering Sensitive Data: Identifying where sensitive data reside is difficult but necessary. You cannot control data if you do not know where those data reside. This lab walks students step-by-step through writing a PowerShell script in order to crawl through a file system looking for sensitive data.

Secure Virtualization: The focus of this lab is on showing the implication of attackers gaining host access to a hypervisor or container system, and also on various hardening and incident handling steps that can be taken

CPE/CMU Credits: 6

Topics
Application (Reverse) Proxies
Full Stack Security Design
Web Server
App Server
DB Server
Web Application Firewalls
Whitelisting and Blacklisting
WAF Bypass
Normalization
Dynamic Content Routing
Database Firewalls/Database Activity Monitoring
Data Masking
Advanced Access Controls
Exfiltration Monitoring
File Classification
Data Discovery
Scripts vs. Software Solutions
Find Sensitive Data in Databases or Files/Folders
Advanced Discovery Techniques such as Optical Character Recognition Scanning of Pictures and Saved Scan Files
Methods of Classification
Dynamic Access Control
Data Loss Prevention (DLP)
Network-based
Endpoint-based
Cloud Application Implementations
Data Governance
Policy Implementation and Enforcement
Access Controls vs. Application Enforcement and Encryption
Auditing and Restrictions
Mobile Device Management (MDM) and Mobile Application Management (MAM)
Security Policies
Methods for Enforcement
End-user Experience and Impact
Private Cloud Security
Securing On-premise Hypervisors (vSphere, Xen, Hyper-V)
Network Segmentation (Logical and Physical)
VM Escape
Surface Reduction
Visibility Advantages
Public Cloud Security
SaaS vs. PaaS vs. IaaS
Shared Responsibility Implications
Cloud Strengths and Weaknesses
Data Remanence and Lack of Network Visibility
Container Security
Impact of Containers on On-premise or Cloud Architectures
Security Concerns
Protecting against Container Escape

Today, a common security mantra is "trust but verify." But this is a broken concept. Computers are capable of calculating trust on the fly, so rather than thinking in terms of "trust but verify" organizations should be implementing "verify then trust." By doing so, access can be constrained to appropriate levels at the same time that access can become more fluid.

This section focuses on implementing a zero-trust architecture where trust is no longer implied but must be proven. By doing so, a model of variable trust can be used to change access levels dynamically. This, in turn, allows for implementing fewer or more security controls as necessary given a user's and a device's trust maintained over time. The focus is on implementing zero-trust architecture with existing security technologies to maximize their value and impact for an organization's security posture.

During this section encryption and authentication will be used to create a hardened network, whether external or internal. Also, advanced defensive techniques will be implemented to stop modern attack tools in their tracks while leaving services fully functional for authorized assets.

Exercises
Network Isolation and Mutual Authentication: Attackers cannot attack what they cannot see or interact with. This lab shows defenders how to implement SPA or mutual TLS so that only authorized assets can connect.
SIEM Analysis and Tactical Detection: Logging and inspecting is difficult without the right data and the proper ability to view those data. This lab shows how to use a SIEM system to find an attacker more than 10 different ways. The detection capabilities are important but the logic behind them is also important to implement variable trust conditional access across an enterprise.
Advanced Defense Strategies: Attackers do not play fair and neither should defenders. In this lab, students will configure services to identify attacks in a way that internal systems continue to function but attack tools do not. Also, specialized detection honeytokens will be implemented to identify attackers cloning a public site and using it against your staff or external clients
CPE/CMU Credits: 6

Topics
Zero Trust Architecture
Why Perimeter Security Is Insufficient
What Zero Trust Architecture Means
"Trust but Verify" vs. "Verify then Trust"
Implementing Variable Access
Logging and Inspection
Network Agent-based Identity Controls
Credential Rotation
Certificates
Passwords and Impact of Rotation
Endpoints
Compromised Internal Assets
Pivoting Adversaries
Insider Threat
Securing the Network
Authenticating and Encrypting Endpoint Traffic
Domain Isolation (Making Endpoint Invisible to Unauthorized Parties)
Mutual TLS
Single Packet Authorization
Tripwire and Red Herring Defenses
Honeynets, Honeypots, and Honeytokens
Single Access Detection Techniques
Proactive Defenses to Change Attacker Tool Behaviors
Increasing Prevention Capabilities while Adding Solid Detection
Patching

Automation via Scripts
Deputizing Endpoints as Hardened Security Sensors
End-user Privilege Reduction
Application Whitelisting
Host Hardening

EMET
Host-based IDS/IPS

As Tripwires
Endpoint Firewalls

Pivot Detection
Scaling Endpoint Log Collection/Storage/Analysis
How to Enable Logs that Matter
Designing for Analysis Rather than Log Collection

The course culminates in a team-based Design-and-Secure-the-Flag competition. Powered by NetWars, day six provides a full day of hands-on work applying the principles taught throughout the week. Your team will progress through multiple levels and missions designed to ensure mastery of the modern cyber defense techniques promoted throughout this course. Teams will assess, design, and secure a variety of computer systems and devices, leveraging all seven layers of the OSI model.

CPE/CMU Credits: 6

Topics
Capstone - Design/Detect/Defend
Defensible Security Architecture
Assess Provided Architecture and Identify Weaknesses
Use Tools/Scripts to Assess the Initial State
Quickly/Thoroughly Find All Changes Made
